#pragma once

#include <cmath>
#include <Eigen/Dense>
#include <stdio.h>
#include <boost/array.hpp>
#include <geometry_msgs/Point.h>
#include <geometry_msgs/Twist.h>
#include <tf_conversions/tf_eigen.h>
#include <geometry_msgs/Point.h>
#include <vector>

using namespace std;
using namespace Eigen;
using namespace Eigen::internal;
using namespace Eigen::Architecture;

typedef Matrix<double, 6, 1> Vector6d;
typedef Matrix<double, 6, 6> Matrix6d;
typedef Matrix<double, 15, 1> Vector15d;
typedef Matrix<double, 15, 15> Matrix15d;

namespace BodyMath
{

struct sphere
{
    double radius;

    Vector3d position;

    Matrix<double,3,15> jacobian_matrix;

    vector<int> collision_check;
};

// -------------------------------------------------------critical point ---------------------------------------------------//
inline Vector3d critiacal_position(const int i ,const double xwb, const double ywb, const double qb, const double q1, const double q2, const double q3, const double q4, const double q5)
{
    Vector3d sphere_postion;
    
    switch (i)
    {
    case 0: 
        sphere_postion << xwb + (229*cos(qb))/500 - (391*sin(qb))/2000,
                ywb + (391*cos(qb))/2000 + (229*sin(qb))/500,
                                         6.0/5;
        break;
    case 1:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000,
                ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500,
                                                6.0/5;
        break;
    case 6:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/20 + (299*sin(q2)*sin(qb))/625 - (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/20 - (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                        cos(q1)/20 + (299*cos(q2)*sin(q1))/625 + 6.0/5;
        break;
    case 4:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (821*sin(q2)*sin(qb))/2500 - (821*cos(q1)*cos(q2)*cos(qb))/2500,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (821*cos(qb)*sin(q2))/2500 + (1807*sin(q1)*sin(qb))/10000 - (821*cos(q1)*cos(q2)*sin(qb))/2500,
                                                                                       (1807*cos(q1))/10000 + (821*cos(q2)*sin(q1))/2500 + 6.0/5;
        break;
    case 3:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (223*sin(q2)*sin(qb))/1250 - (223*cos(q1)*cos(q2)*cos(qb))/1250,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (223*cos(qb)*sin(q2))/1250 + (1807*sin(q1)*sin(qb))/10000 - (223*cos(q1)*cos(q2)*sin(qb))/1250,
                                                                                       (1807*cos(q1))/10000 + (223*cos(q2)*sin(q1))/1250 + 6.0/5;
        break;
    case 5:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (299*sin(q2)*sin(qb))/625 - (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (1807*sin(q1)*sin(qb))/10000 - (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                      (1807*cos(q1))/10000 + (299*cos(q2)*sin(q1))/625 + 6.0/5;
        break;
    case 2:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (71*sin(q2)*sin(qb))/2500 - (71*cos(q1)*cos(q2)*cos(qb))/2500,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (71*cos(qb)*sin(q2))/2500 + (1807*sin(q1)*sin(qb))/10000 - (71*cos(q1)*cos(q2)*sin(qb))/2500,
                                                                                      (1807*cos(q1))/10000 + (71*cos(q2)*sin(q1))/2500 + 6.0/5;
        break;
    case 9:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (39*cos(qb)*sin(q1))/1000 + (299*sin(q2)*sin(qb))/625 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (39*sin(q1)*sin(qb))/1000 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                                              (39*cos(q1))/1000 + (299*cos(q2)*sin(q1))/625 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 8:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (39*cos(qb)*sin(q1))/1000 + (299*sin(q2)*sin(qb))/625 + (6*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (6*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (39*sin(q1)*sin(qb))/1000 - (6*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (6*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                (39*cos(q1))/1000 + (299*cos(q2)*sin(q1))/625 - (3*cos(q2 + q3)*sin(q1))/25 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 7:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (39*cos(qb)*sin(q1))/1000 + (299*sin(q2)*sin(qb))/625 + (3*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (3*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (39*sin(q1)*sin(qb))/1000 - (3*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (3*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                (39*cos(q1))/1000 + (299*cos(q2)*sin(q1))/625 - (6*cos(q2 + q3)*sin(q1))/25 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;        
                                                                                                                break;
    case 10:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (3483*cos(qb)*sin(q1))/20000 + (299*sin(q2)*sin(qb))/625 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (3483*sin(q1)*sin(qb))/20000 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                                              (3483*cos(q1))/20000 + (299*cos(q2)*sin(q1))/625 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 11:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (3483*cos(qb)*sin(q1))/20000 + (299*sin(q2)*sin(qb))/625 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (3483*sin(q1)*sin(qb))/20000 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                                                                                                                                                              (3483*cos(q1))/20000 + (299*cos(q2)*sin(q1))/625 - (2397*cos(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/20000 + (2397*sin(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/20000 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 13:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (3483*cos(qb)*sin(q1))/20000 + (299*sin(q2)*sin(qb))/625 + (2331*sin(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (299*cos(q1)*cos(q2)*cos(qb))/625 + (2331*cos(q5)*cos(qb)*sin(q1))/20000,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (3483*sin(q1)*sin(qb))/20000 - (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (299*cos(q1)*cos(q2)*sin(qb))/625 + (2331*cos(q5)*sin(q1)*sin(qb))/20000,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (3483*cos(q1))/20000 + (2331*cos(q1)*cos(q5))/20000 + (299*cos(q2)*sin(q1))/625 - (2397*sin(q2 + q3 + q4)*sin(q1))/20000 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (2331*cos(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 12:
        sphere_postion << xwb + (229*cos(qb))/500 - (1631*sin(qb))/5000 + (3483*cos(qb)*sin(q1))/20000 + (299*sin(q2)*sin(qb))/625 + (1431*sin(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (299*cos(q1)*cos(q2)*cos(qb))/625 + (1431*cos(q5)*cos(qb)*sin(q1))/20000,
ywb + (1631*cos(qb))/5000 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (3483*sin(q1)*sin(qb))/20000 - (1431*sin(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (299*cos(q1)*cos(q2)*sin(qb))/625 + (1431*cos(q5)*sin(q1)*sin(qb))/20000,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (3483*cos(q1))/20000 + (1431*cos(q1)*cos(q5))/20000 + (299*cos(q2)*sin(q1))/625 - (2397*sin(q2 + q3 + q4)*sin(q1))/20000 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (1431*cos(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (3483*cos(q1))/20000 + (1431*cos(q1)*cos(q5))/20000 + (299*cos(q2)*sin(q1))/625 - (2397*sin(q2 + q3 + q4)*sin(q1))/20000 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (1431*cos(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    // right arm
    case 14:
        sphere_postion << xwb + (229*cos(qb))/500 + (883*sin(qb))/5000,
ywb - (883*cos(qb))/5000 + (229*sin(qb))/500,
                                         6.0/5;
        break;
    case 15:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500,
                                         6.0/5;
        break;
    case 20:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (9*cos(qb)*sin(q1))/200 - (299*sin(q2)*sin(qb))/625 + (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 - (9*sin(q1)*sin(qb))/200 + (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                       (9*cos(q1))/200 + (299*cos(q2)*sin(q1))/625 + 6.0/5;
        break;
    case 19:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (1807*cos(qb)*sin(q1))/10000 - (299*sin(q2)*sin(qb))/625 + (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 - (1807*sin(q1)*sin(qb))/10000 + (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                       (1807*cos(q1))/10000 + (299*cos(q2)*sin(q1))/625 + 6.0/5;
        break;
    case 18:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (1807*cos(qb)*sin(q1))/10000 - (821*sin(q2)*sin(qb))/2500 + (821*cos(q1)*cos(q2)*cos(qb))/2500,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (821*cos(qb)*sin(q2))/2500 - (1807*sin(q1)*sin(qb))/10000 + (821*cos(q1)*cos(q2)*sin(qb))/2500,
                                                                                        (1807*cos(q1))/10000 + (821*cos(q2)*sin(q1))/2500 + 6.0/5;
        break;
    case 17:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (1807*cos(qb)*sin(q1))/10000 - (223*sin(q2)*sin(qb))/1250 + (223*cos(q1)*cos(q2)*cos(qb))/1250,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (223*cos(qb)*sin(q2))/1250 - (1807*sin(q1)*sin(qb))/10000 + (223*cos(q1)*cos(q2)*sin(qb))/1250,
                                                                                        (1807*cos(q1))/10000 + (223*cos(q2)*sin(q1))/1250 + 6.0/5;
        break;
    case 16:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (1807*cos(qb)*sin(q1))/10000 - (71*sin(q2)*sin(qb))/2500 + (71*cos(q1)*cos(q2)*cos(qb))/2500,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (71*cos(qb)*sin(q2))/2500 - (1807*sin(q1)*sin(qb))/10000 + (71*cos(q1)*cos(q2)*sin(qb))/2500,
                                                                                       (1807*cos(q1))/10000 + (71*cos(q2)*sin(q1))/2500 + 6.0/5;
        break;
    case 23:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (39*cos(qb)*sin(q1))/1000 - (299*sin(q2)*sin(qb))/625 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 - (39*sin(q1)*sin(qb))/1000 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                                               (39*cos(q1))/1000 + (299*cos(q2)*sin(q1))/625 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 22:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (39*cos(qb)*sin(q1))/1000 - (299*sin(q2)*sin(qb))/625 - (6*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (6*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 - (39*sin(q1)*sin(qb))/1000 + (6*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (6*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                 (39*cos(q1))/1000 + (299*cos(q2)*sin(q1))/625 - (3*cos(q2 + q3)*sin(q1))/25 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 21:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (39*cos(qb)*sin(q1))/1000 - (299*sin(q2)*sin(qb))/625 - (3*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (3*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 - (39*sin(q1)*sin(qb))/1000 + (3*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (3*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                 (39*cos(q1))/1000 + (299*cos(q2)*sin(q1))/625 - (6*cos(q2 + q3)*sin(q1))/25 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 24:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (3483*cos(qb)*sin(q1))/20000 - (299*sin(q2)*sin(qb))/625 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 - (3483*sin(q1)*sin(qb))/20000 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                                               (3483*cos(q1))/20000 + (299*cos(q2)*sin(q1))/625 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 25:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (3483*cos(qb)*sin(q1))/20000 - (299*sin(q2)*sin(qb))/625 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 - (3483*sin(q1)*sin(qb))/20000 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                                                                                                                                                               (3483*cos(q1))/20000 + (299*cos(q2)*sin(q1))/625 - (2397*cos(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/20000 + (2397*sin(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/20000 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 27:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (3483*cos(qb)*sin(q1))/20000 - (299*sin(q2)*sin(qb))/625 - (2331*sin(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (299*cos(q1)*cos(q2)*cos(qb))/625 - (2331*cos(q5)*cos(qb)*sin(q1))/20000,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 - (3483*sin(q1)*sin(qb))/20000 + (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (299*cos(q1)*cos(q2)*sin(qb))/625 - (2331*cos(q5)*sin(q1)*sin(qb))/20000,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (3483*cos(q1))/20000 + (2331*cos(q1)*cos(q5))/20000 + (299*cos(q2)*sin(q1))/625 - (2397*sin(q2 + q3 + q4)*sin(q1))/20000 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (2331*cos(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    case 26:
        sphere_postion << xwb + (229*cos(qb))/500 + (3273*sin(qb))/10000 - (3483*cos(qb)*sin(q1))/20000 - (299*sin(q2)*sin(qb))/625 - (1531*sin(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (299*cos(q1)*cos(q2)*cos(qb))/625 - (1531*cos(q5)*cos(qb)*sin(q1))/20000,
ywb - (3273*cos(qb))/10000 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 - (3483*sin(q1)*sin(qb))/20000 + (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (299*cos(q1)*cos(q2)*sin(qb))/625 - (1531*cos(q5)*sin(q1)*sin(qb))/20000,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (3483*cos(q1))/20000 + (1531*cos(q1)*cos(q5))/20000 + (299*cos(q2)*sin(q1))/625 - (2397*sin(q2 + q3 + q4)*sin(q1))/20000 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (1531*cos(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
        break;
    // base
    case 28:
        sphere_postion << xwb + (229*cos(qb))/500,
ywb + (229*sin(qb))/500,
                    6.3/5;            
        break;
    case 29:
        sphere_postion << xwb + (229*cos(qb))/500,
ywb + (229*sin(qb))/500,
                    5.2/5;       
        break;
    case 30:
        sphere_postion << xwb + (229*cos(qb))/500,
ywb + (229*sin(qb))/500,
                    4.1/5;       
        break;
    case 31:
        sphere_postion << xwb + (229*cos(qb))/500,
ywb + (229*sin(qb))/500,
                    3.0/5;       
        break;
    case 32:
        sphere_postion << xwb - (1.5*cos(qb))/10,
ywb - (1.5*sin(qb))/10,
                 3.7/5;       
        break;
    case 33:
        sphere_postion << xwb + (3*cos(qb))/10 - sin(qb)/5,
ywb + cos(qb)/5 + (3*sin(qb))/10,
                            3.0/10;     
        break;
    case 34:
        sphere_postion << xwb + (3*cos(qb))/10 + sin(qb)/5,
ywb - cos(qb)/5 + (3*sin(qb))/10,
                            3.0/10;       
        break;
    default:
        sphere_postion.setZero();
        break;
    }
    return sphere_postion;
}

inline Matrix<double, 3, 15> getJacobiantouch_cpoint(const int i,const double qb, const double q1, const double q2, const double q3, const double q4, const double q5, const double q6)
{
    Matrix<double, 3, 15> jacobi_3_15;
    switch(i){
        case 0: 
            jacobi_3_15 << 1, 0, (293*cos(qb))/2000 - (239*sin(qb))/500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (239*cos(qb))/500 + (293*sin(qb))/2000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 1:
            jacobi_3_15 << 1, 0, - (171*cos(qb))/5000 - (229*sin(qb))/500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1,   (229*cos(qb))/500 - (171*sin(qb))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 2:
            jacobi_3_15 << 1, 0, (71*cos(qb)*sin(q2))/2500 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (71*cos(q1)*cos(q2)*sin(qb))/2500, (1807*cos(q1)*cos(qb))/10000 + (71*cos(q2)*cos(qb)*sin(q1))/2500, (71*cos(q2)*sin(qb))/2500 + (71*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (71*sin(q2)*sin(qb))/2500 - (71*cos(q1)*cos(q2)*cos(qb))/2500, (1807*cos(q1)*sin(qb))/10000 + (71*cos(q2)*sin(q1)*sin(qb))/2500, (71*cos(q1)*sin(q2)*sin(qb))/2500 - (71*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                      0,                 (71*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                    -(71*sin(q1)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;        
        case 3:
            jacobi_3_15 << 1, 0, (223*cos(qb)*sin(q2))/1250 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (223*cos(q1)*cos(q2)*sin(qb))/1250, (1807*cos(q1)*cos(qb))/10000 + (223*cos(q2)*cos(qb)*sin(q1))/1250, (223*cos(q2)*sin(qb))/1250 + (223*cos(q1)*cos(qb)*sin(q2))/1250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (223*sin(q2)*sin(qb))/1250 - (223*cos(q1)*cos(q2)*cos(qb))/1250, (1807*cos(q1)*sin(qb))/10000 + (223*cos(q2)*sin(q1)*sin(qb))/1250, (223*cos(q1)*sin(q2)*sin(qb))/1250 - (223*cos(q2)*cos(qb))/1250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                        0,                 (223*cos(q1)*cos(q2))/1250 - (1807*sin(q1))/10000,                                     -(223*sin(q1)*sin(q2))/1250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 4:
            jacobi_3_15 << 1, 0, (821*cos(qb)*sin(q2))/2500 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (821*cos(q1)*cos(q2)*sin(qb))/2500, (1807*cos(q1)*cos(qb))/10000 + (821*cos(q2)*cos(qb)*sin(q1))/2500, (821*cos(q2)*sin(qb))/2500 + (821*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (821*sin(q2)*sin(qb))/2500 - (821*cos(q1)*cos(q2)*cos(qb))/2500, (1807*cos(q1)*sin(qb))/10000 + (821*cos(q2)*sin(q1)*sin(qb))/2500, (821*cos(q1)*sin(q2)*sin(qb))/2500 - (821*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                        0,                 (821*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                     -(821*sin(q1)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
             break;
        case 5:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (299*cos(q1)*cos(q2)*sin(qb))/625, (1807*cos(q1)*cos(qb))/10000 + (299*cos(q2)*cos(qb)*sin(q1))/625, (299*cos(q2)*sin(qb))/625 + (299*cos(q1)*cos(qb)*sin(q2))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (299*sin(q2)*sin(qb))/625 - (299*cos(q1)*cos(q2)*cos(qb))/625, (1807*cos(q1)*sin(qb))/10000 + (299*cos(q2)*sin(q1)*sin(qb))/625, (299*cos(q1)*sin(q2)*sin(qb))/625 - (299*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                      0,                 (299*cos(q1)*cos(q2))/625 - (1807*sin(q1))/10000,                                    -(299*sin(q1)*sin(q2))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 6:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (9*sin(q1)*sin(qb))/200 + (299*cos(q1)*cos(q2)*sin(qb))/625, (9*cos(q1)*cos(qb))/200 + (299*cos(q2)*cos(qb)*sin(q1))/625, (299*cos(q2)*sin(qb))/625 + (299*cos(q1)*cos(qb)*sin(q2))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (9*cos(qb)*sin(q1))/200 + (299*sin(q2)*sin(qb))/625 - (299*cos(q1)*cos(q2)*cos(qb))/625, (9*cos(q1)*sin(qb))/200 + (299*cos(q2)*sin(q1)*sin(qb))/625, (299*cos(q1)*sin(q2)*sin(qb))/625 - (299*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                 0,                 (299*cos(q1)*cos(q2))/625 - (9*sin(q1))/200,                                    -(299*sin(q1)*sin(q2))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 7:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (39*sin(q1)*sin(qb))/1000 + (3*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (3*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625, (39*cos(q1)*cos(qb))/1000 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (3*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (3*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (299*cos(q2)*sin(qb))/625 + (3*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (3*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (299*cos(q1)*cos(qb)*sin(q2))/625, (3*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (3*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (39*cos(qb)*sin(q1))/1000 + (299*sin(q2)*sin(qb))/625 + (3*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (3*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625, (39*cos(q1)*sin(qb))/1000 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (3*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (3*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (3*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (3*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (3*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (3*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                             0,   (299*cos(q1)*cos(q2))/625 - (39*sin(q1))/1000 - (6*cos(q2 + q3)*cos(q1))/25 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                               (6*sin(q2 + q3)*sin(q1))/25 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                           (6*sin(q2 + q3)*sin(q1))/25 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
           break;
        case 8:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (39*sin(q1)*sin(qb))/1000 + (6*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (6*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625, (39*cos(q1)*cos(qb))/1000 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (6*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (6*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (299*cos(q2)*sin(qb))/625 + (6*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (6*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (299*cos(q1)*cos(qb)*sin(q2))/625, (6*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (6*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (39*cos(qb)*sin(q1))/1000 + (299*sin(q2)*sin(qb))/625 + (6*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (6*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625, (39*cos(q1)*sin(qb))/1000 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (6*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (6*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (6*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (6*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (6*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (6*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                             0,   (299*cos(q1)*cos(q2))/625 - (39*sin(q1))/1000 - (3*cos(q2 + q3)*cos(q1))/25 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                               (3*sin(q2 + q3)*sin(q1))/25 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                           (3*sin(q2 + q3)*sin(q1))/25 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 9:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (39*sin(q1)*sin(qb))/1000 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625, (39*cos(q1)*cos(qb))/1000 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (9*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (9*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (299*cos(q2)*sin(qb))/625 + (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (299*cos(q1)*cos(qb)*sin(q2))/625, (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (39*cos(qb)*sin(q1))/1000 + (299*sin(q2)*sin(qb))/625 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625, (39*cos(q1)*sin(qb))/1000 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (9*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (9*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                             0,                                 (299*cos(q1)*cos(q2))/625 - (39*sin(q1))/1000 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                                           - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                       - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 10:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (3483*sin(q1)*sin(qb))/20000 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625, (3483*cos(q1)*cos(qb))/20000 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (9*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (9*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (299*cos(q2)*sin(qb))/625 + (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (299*cos(q1)*cos(qb)*sin(q2))/625, (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (3483*cos(qb)*sin(q1))/20000 + (299*sin(q2)*sin(qb))/625 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625, (3483*cos(q1)*sin(qb))/20000 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (9*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (9*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                                0,                                 (299*cos(q1)*cos(q2))/625 - (3483*sin(q1))/20000 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                                           - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                       - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 11:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (3483*sin(q1)*sin(qb))/20000 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (299*cos(q1)*cos(q2)*sin(qb))/625, (3483*cos(q1)*cos(qb))/20000 - (2397*cos(q4)*(cos(q2)*cos(qb)*sin(q1)*sin(q3) + cos(q3)*cos(qb)*sin(q1)*sin(q2)))/20000 - (2397*sin(q4)*(cos(q2)*cos(q3)*cos(qb)*sin(q1) - cos(qb)*sin(q1)*sin(q2)*sin(q3)))/20000 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (9*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (9*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (299*cos(q2)*sin(qb))/625 + (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 + (299*cos(q1)*cos(qb)*sin(q2))/625, (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000, - (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (3483*cos(qb)*sin(q1))/20000 + (299*sin(q2)*sin(qb))/625 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (299*cos(q1)*cos(q2)*cos(qb))/625, (3483*cos(q1)*sin(qb))/20000 - (2397*cos(q4)*(cos(q2)*sin(q1)*sin(q3)*sin(qb) + cos(q3)*sin(q1)*sin(q2)*sin(qb)))/20000 - (2397*sin(q4)*(cos(q2)*cos(q3)*sin(q1)*sin(qb) - sin(q1)*sin(q2)*sin(q3)*sin(qb)))/20000 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (9*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (9*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q2)*cos(qb))/625 + (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 + (299*cos(q1)*sin(q2)*sin(qb))/625, (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000,   (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                 (299*cos(q1)*cos(q2))/625 - (3483*sin(q1))/20000 - (2397*cos(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)))/20000 - (2397*sin(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)))/20000 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                                                                                                                                                             (2397*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/20000 - (299*sin(q1)*sin(q2))/625 + (2397*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                                                                         (2397*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/20000 + (2397*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                   (2397*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/20000 + (2397*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/20000, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 12:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (3483*sin(q1)*sin(qb))/20000 + (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (299*cos(q1)*cos(q2)*sin(qb))/625 - (1531*cos(q5)*sin(q1)*sin(qb))/20000, (3483*cos(q1)*cos(qb))/20000 + (1531*sin(q5)*(cos(q4)*(cos(q2)*cos(q3)*cos(qb)*sin(q1) - cos(qb)*sin(q1)*sin(q2)*sin(q3)) - sin(q4)*(cos(q2)*cos(qb)*sin(q1)*sin(q3) + cos(q3)*cos(qb)*sin(q1)*sin(q2))))/20000 - (2397*cos(q4)*(cos(q2)*cos(qb)*sin(q1)*sin(q3) + cos(q3)*cos(qb)*sin(q1)*sin(q2)))/20000 - (2397*sin(q4)*(cos(q2)*cos(q3)*cos(qb)*sin(q1) - cos(qb)*sin(q1)*sin(q2)*sin(q3)))/20000 + (1531*cos(q1)*cos(q5)*cos(qb))/20000 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (9*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (9*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (299*cos(q2)*sin(qb))/625 + (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 + (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 + (299*cos(q1)*cos(qb)*sin(q2))/625, (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 + (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000, (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 - (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000,   (1531*cos(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000 - (1531*cos(qb)*sin(q1)*sin(q5))/20000, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (3483*cos(qb)*sin(q1))/20000 + (299*sin(q2)*sin(qb))/625 + (1531*sin(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (299*cos(q1)*cos(q2)*cos(qb))/625 + (1531*cos(q5)*cos(qb)*sin(q1))/20000, (3483*cos(q1)*sin(qb))/20000 - (2397*cos(q4)*(cos(q2)*sin(q1)*sin(q3)*sin(qb) + cos(q3)*sin(q1)*sin(q2)*sin(qb)))/20000 + (1531*sin(q5)*(cos(q4)*(cos(q2)*cos(q3)*sin(q1)*sin(qb) - sin(q1)*sin(q2)*sin(q3)*sin(qb)) - sin(q4)*(cos(q2)*sin(q1)*sin(q3)*sin(qb) + cos(q3)*sin(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q2)*cos(q3)*sin(q1)*sin(qb) - sin(q1)*sin(q2)*sin(q3)*sin(qb)))/20000 + (1531*cos(q1)*cos(q5)*sin(qb))/20000 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (9*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (9*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 - (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q2)*cos(qb))/625 + (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 + (299*cos(q1)*sin(q2)*sin(qb))/625, (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 + (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, - (1531*cos(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 - (1531*sin(q1)*sin(q5)*sin(qb))/20000, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                        (299*cos(q1)*cos(q2))/625 - (3483*sin(q1))/20000 - (1531*cos(q5)*sin(q1))/20000 - (2397*sin(q2 + q3 + q4)*cos(q1))/20000 + (1531*cos(q2 + q3 + q4)*cos(q1)*sin(q5))/20000 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - (299*sin(q1)*sin(q2))/625 - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (1531*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (1531*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                              - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (1531*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000,                                                                                                                                                                                                                             (1531*cos(q2 + q3 + q4)*cos(q5)*sin(q1))/20000 - (1531*cos(q1)*sin(q5))/20000, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 13:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (3483*sin(q1)*sin(qb))/20000 + (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (299*cos(q1)*cos(q2)*sin(qb))/625 - (2331*cos(q5)*sin(q1)*sin(qb))/20000, (3483*cos(q1)*cos(qb))/20000 + (2331*sin(q5)*(cos(q4)*(cos(q2)*cos(q3)*cos(qb)*sin(q1) - cos(qb)*sin(q1)*sin(q2)*sin(q3)) - sin(q4)*(cos(q2)*cos(qb)*sin(q1)*sin(q3) + cos(q3)*cos(qb)*sin(q1)*sin(q2))))/20000 - (2397*cos(q4)*(cos(q2)*cos(qb)*sin(q1)*sin(q3) + cos(q3)*cos(qb)*sin(q1)*sin(q2)))/20000 - (2397*sin(q4)*(cos(q2)*cos(q3)*cos(qb)*sin(q1) - cos(qb)*sin(q1)*sin(q2)*sin(q3)))/20000 + (2331*cos(q1)*cos(q5)*cos(qb))/20000 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (9*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (9*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (299*cos(q2)*sin(qb))/625 + (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 + (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 + (299*cos(q1)*cos(qb)*sin(q2))/625, (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 + (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000, (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 - (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000,   (2331*cos(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000 - (2331*cos(qb)*sin(q1)*sin(q5))/20000, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (3483*cos(qb)*sin(q1))/20000 + (299*sin(q2)*sin(qb))/625 + (2331*sin(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (299*cos(q1)*cos(q2)*cos(qb))/625 + (2331*cos(q5)*cos(qb)*sin(q1))/20000, (3483*cos(q1)*sin(qb))/20000 - (2397*cos(q4)*(cos(q2)*sin(q1)*sin(q3)*sin(qb) + cos(q3)*sin(q1)*sin(q2)*sin(qb)))/20000 + (2331*sin(q5)*(cos(q4)*(cos(q2)*cos(q3)*sin(q1)*sin(qb) - sin(q1)*sin(q2)*sin(q3)*sin(qb)) - sin(q4)*(cos(q2)*sin(q1)*sin(q3)*sin(qb) + cos(q3)*sin(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q2)*cos(q3)*sin(q1)*sin(qb) - sin(q1)*sin(q2)*sin(q3)*sin(qb)))/20000 + (2331*cos(q1)*cos(q5)*sin(qb))/20000 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (9*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (9*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 - (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q2)*cos(qb))/625 + (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 + (299*cos(q1)*sin(q2)*sin(qb))/625, (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 + (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, - (2331*cos(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 - (2331*sin(q1)*sin(q5)*sin(qb))/20000, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                        (299*cos(q1)*cos(q2))/625 - (3483*sin(q1))/20000 - (2331*cos(q5)*sin(q1))/20000 - (2397*sin(q2 + q3 + q4)*cos(q1))/20000 + (2331*cos(q2 + q3 + q4)*cos(q1)*sin(q5))/20000 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - (299*sin(q1)*sin(q2))/625 - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (2331*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (2331*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                              - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (2331*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000,                                                                                                                                                                                                                             (2331*cos(q2 + q3 + q4)*cos(q5)*sin(q1))/20000 - (2331*cos(q1)*sin(q5))/20000, 0, 0, 0, 0, 0, 0, 0;
            break;

        // right arm
        case 14:
            jacobi_3_15 << 1, 0, (883*cos(qb))/5000 - (229*sin(qb))/500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (883*sin(qb))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;   
        break;
        case 15:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 20:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (9*sin(q1)*sin(qb))/200 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, - (9*cos(q1)*cos(qb))/200 - (299*cos(q2)*cos(qb)*sin(q1))/625, - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (9*cos(qb)*sin(q1))/200 - (299*sin(q2)*sin(qb))/625 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, - (9*cos(q1)*sin(qb))/200 - (299*cos(q2)*sin(q1)*sin(qb))/625,   (299*cos(q2)*cos(qb))/625 - (299*cos(q1)*sin(q2)*sin(qb))/625, 0, 0, 0, 0,
0, 0,                                                                                                                                  0, 0, 0, 0, 0, 0, 0,                   (299*cos(q1)*cos(q2))/625 - (9*sin(q1))/200,                                      -(299*sin(q1)*sin(q2))/625, 0, 0, 0, 0;
            break;
        case 19:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (1807*sin(q1)*sin(qb))/10000 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (299*cos(q2)*cos(qb)*sin(q1))/625, - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (1807*cos(qb)*sin(q1))/10000 - (299*sin(q2)*sin(qb))/625 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (299*cos(q2)*sin(q1)*sin(qb))/625,   (299*cos(q2)*cos(qb))/625 - (299*cos(q1)*sin(q2)*sin(qb))/625, 0, 0, 0, 0,
0, 0,                                                                                                                                       0, 0, 0, 0, 0, 0, 0,                   (299*cos(q1)*cos(q2))/625 - (1807*sin(q1))/10000,                                      -(299*sin(q1)*sin(q2))/625, 0, 0, 0, 0;
   
        break;
        case 18:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (821*cos(qb)*sin(q2))/2500 + (1807*sin(q1)*sin(qb))/10000 - (821*cos(q1)*cos(q2)*sin(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (821*cos(q2)*cos(qb)*sin(q1))/2500, - (821*cos(q2)*sin(qb))/2500 - (821*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (1807*cos(qb)*sin(q1))/10000 - (821*sin(q2)*sin(qb))/2500 + (821*cos(q1)*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (821*cos(q2)*sin(q1)*sin(qb))/2500,   (821*cos(q2)*cos(qb))/2500 - (821*cos(q1)*sin(q2)*sin(qb))/2500, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (821*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                       -(821*sin(q1)*sin(q2))/2500, 0, 0, 0, 0;
        break;
        case 17:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (223*cos(qb)*sin(q2))/1250 + (1807*sin(q1)*sin(qb))/10000 - (223*cos(q1)*cos(q2)*sin(qb))/1250, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (223*cos(q2)*cos(qb)*sin(q1))/1250, - (223*cos(q2)*sin(qb))/1250 - (223*cos(q1)*cos(qb)*sin(q2))/1250, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (1807*cos(qb)*sin(q1))/10000 - (223*sin(q2)*sin(qb))/1250 + (223*cos(q1)*cos(q2)*cos(qb))/1250, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (223*cos(q2)*sin(q1)*sin(qb))/1250,   (223*cos(q2)*cos(qb))/1250 - (223*cos(q1)*sin(q2)*sin(qb))/1250, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (223*cos(q1)*cos(q2))/1250 - (1807*sin(q1))/10000,                                       -(223*sin(q1)*sin(q2))/1250, 0, 0, 0, 0;
        break;
        case 16:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (71*cos(qb)*sin(q2))/2500 + (1807*sin(q1)*sin(qb))/10000 - (71*cos(q1)*cos(q2)*sin(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (71*cos(q2)*cos(qb)*sin(q1))/2500, - (71*cos(q2)*sin(qb))/2500 - (71*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (1807*cos(qb)*sin(q1))/10000 - (71*sin(q2)*sin(qb))/2500 + (71*cos(q1)*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (71*cos(q2)*sin(q1)*sin(qb))/2500,   (71*cos(q2)*cos(qb))/2500 - (71*cos(q1)*sin(q2)*sin(qb))/2500, 0, 0, 0, 0,
0, 0,                                                                                                                                       0, 0, 0, 0, 0, 0, 0,                   (71*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                      -(71*sin(q1)*sin(q2))/2500, 0, 0, 0, 0;   
        break;
        case 23:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (39*sin(q1)*sin(qb))/1000 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (9*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (9*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (39*cos(q1)*cos(qb))/1000, (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (39*cos(qb)*sin(q1))/1000 - (299*sin(q2)*sin(qb))/625 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (9*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (9*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (39*cos(q1)*sin(qb))/1000, (299*cos(q2)*cos(qb))/625 + (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (299*cos(q1)*sin(q2)*sin(qb))/625, (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                              0, 0, 0, 0, 0, 0, 0,                                 (299*cos(q1)*cos(q2))/625 - (39*sin(q1))/1000 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                                           - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                       - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
        break;
        case 22:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (39*sin(q1)*sin(qb))/1000 - (6*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (6*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (6*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (6*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (39*cos(q1)*cos(qb))/1000, (6*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (6*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (6*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (6*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (39*cos(qb)*sin(q1))/1000 - (299*sin(q2)*sin(qb))/625 - (6*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (6*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (6*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (6*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (39*cos(q1)*sin(qb))/1000, (299*cos(q2)*cos(qb))/625 + (6*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (6*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (299*cos(q1)*sin(q2)*sin(qb))/625, (6*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (6*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                              0, 0, 0, 0, 0, 0, 0,   (299*cos(q1)*cos(q2))/625 - (39*sin(q1))/1000 - (3*cos(q2 + q3)*cos(q1))/25 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                               (3*sin(q2 + q3)*sin(q1))/25 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                           (3*sin(q2 + q3)*sin(q1))/25 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;   
        break;
        case 21:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (39*sin(q1)*sin(qb))/1000 - (3*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (3*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (3*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (3*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (39*cos(q1)*cos(qb))/1000, (3*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (3*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (3*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (3*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (39*cos(qb)*sin(q1))/1000 - (299*sin(q2)*sin(qb))/625 - (3*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (3*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (3*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (3*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (39*cos(q1)*sin(qb))/1000, (299*cos(q2)*cos(qb))/625 + (3*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (3*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (299*cos(q1)*sin(q2)*sin(qb))/625, (3*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (3*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                              0, 0, 0, 0, 0, 0, 0,   (299*cos(q1)*cos(q2))/625 - (39*sin(q1))/1000 - (6*cos(q2 + q3)*cos(q1))/25 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                               (6*sin(q2 + q3)*sin(q1))/25 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                           (6*sin(q2 + q3)*sin(q1))/25 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;   
        break;
        case 24:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (3483*sin(q1)*sin(qb))/20000 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (9*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (9*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (3483*cos(q1)*cos(qb))/20000, (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (3483*cos(qb)*sin(q1))/20000 - (299*sin(q2)*sin(qb))/625 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (9*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (9*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (3483*cos(q1)*sin(qb))/20000, (299*cos(q2)*cos(qb))/625 + (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (299*cos(q1)*sin(q2)*sin(qb))/625, (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                                 0, 0, 0, 0, 0, 0, 0,                                 (299*cos(q1)*cos(q2))/625 - (3483*sin(q1))/20000 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                                           - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                       - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
        break;
        case 25:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (3483*sin(q1)*sin(qb))/20000 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (2397*cos(q4)*(cos(q2)*cos(qb)*sin(q1)*sin(q3) + cos(q3)*cos(qb)*sin(q1)*sin(q2)))/20000 - (3483*cos(q1)*cos(qb))/20000 + (2397*sin(q4)*(cos(q2)*cos(q3)*cos(qb)*sin(q1) - cos(qb)*sin(q1)*sin(q2)*sin(q3)))/20000 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (9*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 + (9*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q2)*sin(qb))/625 + (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 - (299*cos(q1)*cos(qb)*sin(q2))/625, (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000,   (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000, 0, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (3483*cos(qb)*sin(q1))/20000 - (299*sin(q2)*sin(qb))/625 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (2397*cos(q4)*(cos(q2)*sin(q1)*sin(q3)*sin(qb) + cos(q3)*sin(q1)*sin(q2)*sin(qb)))/20000 - (3483*cos(q1)*sin(qb))/20000 + (2397*sin(q4)*(cos(q2)*cos(q3)*sin(q1)*sin(qb) - sin(q1)*sin(q2)*sin(q3)*sin(qb)))/20000 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (9*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 + (9*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 - (299*cos(q1)*sin(q2)*sin(qb))/625, (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, - (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, 0, 0,
0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0, 0, 0, 0, 0, 0, 0,                                                                 (299*cos(q1)*cos(q2))/625 - (3483*sin(q1))/20000 - (2397*cos(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)))/20000 - (2397*sin(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)))/20000 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                                                                                                                                                             (2397*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/20000 - (299*sin(q1)*sin(q2))/625 + (2397*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                                                                         (2397*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/20000 + (2397*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                   (2397*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/20000 + (2397*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/20000, 0, 0;   
        break;
        case 27:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (3483*sin(q1)*sin(qb))/20000 - (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (299*cos(q1)*cos(q2)*sin(qb))/625 + (2331*cos(q5)*sin(q1)*sin(qb))/20000, 0, 0, 0, 0, 0, 0, (2397*cos(q4)*(cos(q2)*cos(qb)*sin(q1)*sin(q3) + cos(q3)*cos(qb)*sin(q1)*sin(q2)))/20000 - (2331*sin(q5)*(cos(q4)*(cos(q2)*cos(q3)*cos(qb)*sin(q1) - cos(qb)*sin(q1)*sin(q2)*sin(q3)) - sin(q4)*(cos(q2)*cos(qb)*sin(q1)*sin(q3) + cos(q3)*cos(qb)*sin(q1)*sin(q2))))/20000 - (3483*cos(q1)*cos(qb))/20000 + (2397*sin(q4)*(cos(q2)*cos(q3)*cos(qb)*sin(q1) - cos(qb)*sin(q1)*sin(q2)*sin(q3)))/20000 - (2331*cos(q1)*cos(q5)*cos(qb))/20000 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (9*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 + (9*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 - (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q2)*sin(qb))/625 + (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 - (299*cos(q1)*cos(qb)*sin(q2))/625, (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 + (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000, (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000, (2331*cos(qb)*sin(q1)*sin(q5))/20000 - (2331*cos(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (3483*cos(qb)*sin(q1))/20000 - (299*sin(q2)*sin(qb))/625 - (2331*sin(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (299*cos(q1)*cos(q2)*cos(qb))/625 - (2331*cos(q5)*cos(qb)*sin(q1))/20000, 0, 0, 0, 0, 0, 0, (2397*cos(q4)*(cos(q2)*sin(q1)*sin(q3)*sin(qb) + cos(q3)*sin(q1)*sin(q2)*sin(qb)))/20000 - (3483*cos(q1)*sin(qb))/20000 - (2331*sin(q5)*(cos(q4)*(cos(q2)*cos(q3)*sin(q1)*sin(qb) - sin(q1)*sin(q2)*sin(q3)*sin(qb)) - sin(q4)*(cos(q2)*sin(q1)*sin(q3)*sin(qb) + cos(q3)*sin(q1)*sin(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q2)*cos(q3)*sin(q1)*sin(qb) - sin(q1)*sin(q2)*sin(q3)*sin(qb)))/20000 - (2331*cos(q1)*cos(q5)*sin(qb))/20000 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (9*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 + (9*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 + (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 - (299*cos(q1)*sin(q2)*sin(qb))/625, (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 + (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, (2331*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 - (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, (2331*cos(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 + (2331*sin(q1)*sin(q5)*sin(qb))/20000, 0,
0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0, 0, 0, 0, 0, 0, 0,                                                                                                                                                                                                                                                                                                                        (299*cos(q1)*cos(q2))/625 - (3483*sin(q1))/20000 - (2331*cos(q5)*sin(q1))/20000 - (2397*sin(q2 + q3 + q4)*cos(q1))/20000 + (2331*cos(q2 + q3 + q4)*cos(q1)*sin(q5))/20000 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - (299*sin(q1)*sin(q2))/625 - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (2331*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (2331*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                              - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (2331*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000,                                                                                                                                                                                                                           (2331*cos(q2 + q3 + q4)*cos(q5)*sin(q1))/20000 - (2331*cos(q1)*sin(q5))/20000, 0;  
        break;
        case 26:
            jacobi_3_15 << 1, 0, (3273*cos(qb))/10000 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (3483*sin(q1)*sin(qb))/20000 - (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (299*cos(q1)*cos(q2)*sin(qb))/625 + (1531*cos(q5)*sin(q1)*sin(qb))/20000, 0, 0, 0, 0, 0, 0, (2397*cos(q4)*(cos(q2)*cos(qb)*sin(q1)*sin(q3) + cos(q3)*cos(qb)*sin(q1)*sin(q2)))/20000 - (1531*sin(q5)*(cos(q4)*(cos(q2)*cos(q3)*cos(qb)*sin(q1) - cos(qb)*sin(q1)*sin(q2)*sin(q3)) - sin(q4)*(cos(q2)*cos(qb)*sin(q1)*sin(q3) + cos(q3)*cos(qb)*sin(q1)*sin(q2))))/20000 - (3483*cos(q1)*cos(qb))/20000 + (2397*sin(q4)*(cos(q2)*cos(q3)*cos(qb)*sin(q1) - cos(qb)*sin(q1)*sin(q2)*sin(q3)))/20000 - (1531*cos(q1)*cos(q5)*cos(qb))/20000 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (9*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 + (9*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 - (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q2)*sin(qb))/625 + (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 - (299*cos(q1)*cos(qb)*sin(q2))/625, (9*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 + (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000, (2397*cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 - (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))) - sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))))/20000 + (2397*sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000, (1531*cos(qb)*sin(q1)*sin(q5))/20000 - (1531*cos(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000, 0,
0, 1, (229*cos(qb))/500 + (3273*sin(qb))/10000 - (3483*cos(qb)*sin(q1))/20000 - (299*sin(q2)*sin(qb))/625 - (1531*sin(q5)*(cos(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))) + sin(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))))/20000 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (2397*cos(q4)*(cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb))))/20000 + (2397*sin(q4)*(cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2))))/20000 + (299*cos(q1)*cos(q2)*cos(qb))/625 - (1531*cos(q5)*cos(qb)*sin(q1))/20000, 0, 0, 0, 0, 0, 0, (2397*cos(q4)*(cos(q2)*sin(q1)*sin(q3)*sin(qb) + cos(q3)*sin(q1)*sin(q2)*sin(qb)))/20000 - (3483*cos(q1)*sin(qb))/20000 - (1531*sin(q5)*(cos(q4)*(cos(q2)*cos(q3)*sin(q1)*sin(qb) - sin(q1)*sin(q2)*sin(q3)*sin(qb)) - sin(q4)*(cos(q2)*sin(q1)*sin(q3)*sin(qb) + cos(q3)*sin(q1)*sin(q2)*sin(qb))))/20000 + (2397*sin(q4)*(cos(q2)*cos(q3)*sin(q1)*sin(qb) - sin(q1)*sin(q2)*sin(q3)*sin(qb)))/20000 - (1531*cos(q1)*cos(q5)*sin(qb))/20000 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (9*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 + (9*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 + (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000 - (299*cos(q1)*sin(q2)*sin(qb))/625, (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 + (9*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, (1531*sin(q5)*(cos(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))) - sin(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))))/20000 - (2397*cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))))/20000 - (2397*sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb))))/20000, (1531*cos(q5)*(cos(q4)*(cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb))) + sin(q4)*(cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))))/20000 + (1531*sin(q1)*sin(q5)*sin(qb))/20000, 0,
0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0, 0, 0, 0, 0, 0, 0,                                                                                                                                                                                                                                                                                                                        (299*cos(q1)*cos(q2))/625 - (3483*sin(q1))/20000 - (1531*cos(q5)*sin(q1))/20000 - (2397*sin(q2 + q3 + q4)*cos(q1))/20000 + (1531*cos(q2 + q3 + q4)*cos(q1)*sin(q5))/20000 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - (299*sin(q1)*sin(q2))/625 - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (1531*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (1531*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                                                                                                                                                                                                                                                                                                                                                                                                                              - (2397*cos(q2 + q3 + q4)*sin(q1))/20000 - (1531*sin(q2 + q3 + q4)*sin(q1)*sin(q5))/20000,                                                                                                                                                                                                                           (1531*cos(q2 + q3 + q4)*cos(q5)*sin(q1))/20000 - (1531*cos(q1)*sin(q5))/20000, 0;   
        break;
        // base
        case 28: case 29: case 30: case 31:
            jacobi_3_15 << 1, 0, -(229*sin(qb))/500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1,  (229*cos(qb))/500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
        break;
        case 32:
            jacobi_3_15 << 1, 0,  -(1.5*sin(qb))/10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, -(1.5*sin(qb))/10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
        break;
        case 33:
            jacobi_3_15 << 1, 0, - cos(qb)/5 - (3*sin(qb))/10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1,   (3*cos(qb))/10 - sin(qb)/5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
        break;
        case 34:
            jacobi_3_15 << 1, 0, cos(qb)/5 - (3*sin(qb))/10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (3*cos(qb))/10 + sin(qb)/5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
        break;
        default :
            jacobi_3_15.setZero();
            ROS_ERROR("Wrong cell id!");
            std::cout << i << std::endl;
            break;
    }
    return jacobi_3_15;
}

// ----------------------------------------------------------tactile---------------------------------------------------------//

/**
    * @brief Get rotation matrix for the touch point (left small arm)
    * @detail
    *  Get rotatation matrix for the touch point by the tactile index
    * @param[in] i        tactile index
    * @param[in] q        realtime joint position
    * @param[out] rotatematrix        rotatation matrix
    */
inline Matrix3d getrotate_ls(const double qb, const double q1, const double q2, const double q3)
{   
    Matrix3d rotatematrix;
    
    rotatematrix << - cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) - sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)), sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) - cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)), cos(qb)*sin(q1),
  cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) + sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)), cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)) - sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)), sin(q1)*sin(qb),
                                                                                      -cos(q2 + q3)*sin(q1),                                                                                      sin(q2 + q3)*sin(q1),         cos(q1);
    return rotatematrix;
}

/**
    * @brief Get rotation matrix for the touch point (right small arm)
    * @detail
    *  Get rotatation matrix for the touch point by the tactile index
    * @param[in] i        tactile index
    * @param[in] q        realtime joint position
    * @param[out] rotatematrix        rotatation matrix
    */
inline Matrix3d getrotate_rs(const double qb, const double q1, const double q2, const double q3)
{   
    Matrix3d rotatematrix;
    
    rotatematrix << cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)) + sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)), cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)) - sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)), -cos(qb)*sin(q1),
- cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) - sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)), sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)) - cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)), -sin(q1)*sin(qb),
                                                                                      -cos(q2 + q3)*sin(q1),                                                                                      sin(q2 + q3)*sin(q1),          cos(q1);
    return rotatematrix;
}

/**
    * @brief Get rotation matrix for the touch point
    * @detail
    *  Get jacobian matrix for the touch point by the tactile index
    * @param[in] i        tactile index
    * @param[in] q        realtime joint position
    * @param[out] jacobi_3_15        jacobian matrix (linear)
    */
inline Matrix3d getrotate_lb(const double qb, const double q1, const double q2, const double q3)
{   
    Matrix3d rotatematrix;
    
    rotatematrix << cos(q1)*cos(q2)*cos(qb) - sin(q2)*sin(qb), - cos(q2)*sin(qb) - cos(q1)*cos(qb)*sin(q2), cos(qb)*sin(q1),
cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb),   cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb), sin(q1)*sin(qb),
                         -cos(q2)*sin(q1),                             sin(q1)*sin(q2),         cos(q1);
        return rotatematrix;
}

/**
    * @brief Get rotation matrix for the touch point
    * @detail
    *  Get jacobian matrix for the touch point by the tactile index
    * @param[in] i        tactile index
    * @param[in] q        realtime joint position
    * @param[out] jacobi_3_15        jacobian matrix (linear)
    */
inline Matrix3d getrotate_rb(const double qb, const double q1, const double q2, const double q3)
{   
    Matrix3d rotatematrix;
    rotatematrix << sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb), cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2), -cos(qb)*sin(q1),
- cos(qb)*sin(q2) - cos(q1)*cos(q2)*sin(qb), cos(q1)*sin(q2)*sin(qb) - cos(q2)*cos(qb), -sin(q1)*sin(qb),
                           -cos(q2)*sin(q1),                           sin(q1)*sin(q2),          cos(q1);
        return rotatematrix;
}

/**
    * @brief Get jacobian matrix (linear) for the touch point
    * @detail
    *  Get jacobian matrix for the touch point by the tactile index
    * @param[in] i        tactile index
    * @param[in] q        realtime joint position
    * @param[out] jacobi_3_15        jacobian matrix (linear)
    */
inline Matrix<double, 3, 15> getJacobiantouch_ls(const int i,const double qb, const double q1, const double q2, const double q3, const double q4, const double q5, const double q6)
{
    Matrix<double, 3, 15> jacobi_3_15;
    switch(i){
        case 1: 
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/10 + (sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/10 + (299*cos(q1)*cos(q2)*sin(qb))/625,  (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (cos(q2)*cos(q3)*cos(qb)*sin(q1))/10 - (cos(qb)*sin(q1)*sin(q2)*sin(q3))/10, (299*cos(q2)*sin(qb))/625 + (cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/10 - (sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/10 + (299*cos(q1)*cos(qb)*sin(q2))/625, (cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/10 - (sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/10, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/10 + (sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/10 - (299*cos(q1)*cos(q2)*cos(qb))/625,  (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (cos(q2)*cos(q3)*sin(q1)*sin(qb))/10 - (sin(q1)*sin(q2)*sin(q3)*sin(qb))/10, (sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/10 - (cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/10 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/10 - (cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/10, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                    0, (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (13*cos(q2 + q3)*cos(q1))/50 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                          (13*sin(q2 + q3)*sin(q1))/50 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                      (13*sin(q2 + q3)*sin(q1))/50 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 2:
            jacobi_3_15 <<1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (23*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 + (23*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (23*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (23*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200, (299*cos(q2)*sin(qb))/625 + (23*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (23*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (299*cos(q1)*cos(qb)*sin(q2))/625, (23*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (23*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (23*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (23*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (23*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (23*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200, (23*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (23*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (23*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (23*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                            0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (49*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (49*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (49*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 3:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (13*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 + (13*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (13*cos(q2)*cos(q3)*cos(qb)*sin(q1))/100 - (13*cos(qb)*sin(q1)*sin(q2)*sin(q3))/100, (299*cos(q2)*sin(qb))/625 + (13*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (13*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 + (299*cos(q1)*cos(qb)*sin(q2))/625, (13*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (13*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (13*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 + (13*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (13*cos(q2)*cos(q3)*sin(q1)*sin(qb))/100 - (13*sin(q1)*sin(q2)*sin(q3)*sin(qb))/100, (13*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (13*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (13*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (13*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                            0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (23*cos(q2 + q3)*cos(q1))/100 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (23*sin(q2 + q3)*sin(q1))/100 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (23*sin(q2 + q3)*sin(q1))/100 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;        
        case 4:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (29*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 + (29*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (29*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (29*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200, (299*cos(q2)*sin(qb))/625 + (29*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (29*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (299*cos(q1)*cos(qb)*sin(q2))/625, (29*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (29*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (29*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (29*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (29*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (29*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200, (29*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (29*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (29*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (29*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                            0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (43*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (43*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (43*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 5:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (4*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (4*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (4*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (4*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (299*cos(q2)*sin(qb))/625 + (4*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (4*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (299*cos(q1)*cos(qb)*sin(q2))/625, (4*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (4*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (4*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (4*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (4*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (4*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (4*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (4*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (4*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (4*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                        0,        (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (cos(q2 + q3)*cos(q1))/5 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                  (sin(q2 + q3)*sin(q1))/5 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                              (sin(q2 + q3)*sin(q1))/5 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
             break;
        case 6:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (7*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40 + (7*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (7*cos(q2)*cos(q3)*cos(qb)*sin(q1))/40 - (7*cos(qb)*sin(q1)*sin(q2)*sin(q3))/40, (299*cos(q2)*sin(qb))/625 + (7*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40 - (7*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40 + (299*cos(q1)*cos(qb)*sin(q2))/625, (7*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40 - (7*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (7*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40 + (7*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (7*cos(q2)*cos(q3)*sin(q1)*sin(qb))/40 - (7*sin(q1)*sin(q2)*sin(q3)*sin(qb))/40, (7*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40 - (7*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (7*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40 - (7*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                        0,   (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (37*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                             (37*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                         (37*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 7:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (19*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 + (19*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (19*cos(q2)*cos(q3)*cos(qb)*sin(q1))/100 - (19*cos(qb)*sin(q1)*sin(q2)*sin(q3))/100, (299*cos(q2)*sin(qb))/625 + (19*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (19*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 + (299*cos(q1)*cos(qb)*sin(q2))/625, (19*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (19*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (19*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 + (19*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (19*cos(q2)*cos(q3)*sin(q1)*sin(qb))/100 - (19*sin(q1)*sin(q2)*sin(q3)*sin(qb))/100, (19*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (19*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (19*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (19*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                            0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (17*cos(q2 + q3)*cos(q1))/100 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (17*sin(q2 + q3)*sin(q1))/100 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (17*sin(q2 + q3)*sin(q1))/100 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 8:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (41*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 + (41*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (41*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (41*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200, (299*cos(q2)*sin(qb))/625 + (41*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (41*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (299*cos(q1)*cos(qb)*sin(q2))/625, (41*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (41*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (41*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (41*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (41*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (41*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200, (41*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (41*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (41*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (41*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                            0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (31*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (31*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (31*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
           break;
        case 9:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (11*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/50 + (11*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/50 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (11*cos(q2)*cos(q3)*cos(qb)*sin(q1))/50 - (11*cos(qb)*sin(q1)*sin(q2)*sin(q3))/50, (299*cos(q2)*sin(qb))/625 + (11*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/50 - (11*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/50 + (299*cos(q1)*cos(qb)*sin(q2))/625, (11*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/50 - (11*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/50, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (11*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/50 + (11*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/50 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (11*cos(q2)*cos(q3)*sin(q1)*sin(qb))/50 - (11*sin(q1)*sin(q2)*sin(q3)*sin(qb))/50, (11*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/50 - (11*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/50 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (11*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/50 - (11*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/50, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                          0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (7*cos(q2 + q3)*cos(q1))/50 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (7*sin(q2 + q3)*sin(q1))/50 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (7*sin(q2 + q3)*sin(q1))/50 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 10:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (47*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 + (47*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (47*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (47*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200, (299*cos(q2)*sin(qb))/625 + (47*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (47*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (299*cos(q1)*cos(qb)*sin(q2))/625, (47*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (47*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (47*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (47*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (47*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (47*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200, (47*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (47*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (47*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (47*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                            0,            (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (cos(q2 + q3)*cos(q1))/8 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                      (sin(q2 + q3)*sin(q1))/8 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                  (sin(q2 + q3)*sin(q1))/8 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 11:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/4 + (sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/4 + (299*cos(q1)*cos(q2)*sin(qb))/625,     (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (cos(q2)*cos(q3)*cos(qb)*sin(q1))/4 - (cos(qb)*sin(q1)*sin(q2)*sin(q3))/4, (299*cos(q2)*sin(qb))/625 + (cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/4 - (sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/4 + (299*cos(q1)*cos(qb)*sin(q2))/625, (cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/4 - (sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/4, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/4 + (sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/4 - (299*cos(q1)*cos(q2)*cos(qb))/625,     (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (cos(q2)*cos(q3)*sin(q1)*sin(qb))/4 - (sin(q1)*sin(q2)*sin(q3)*sin(qb))/4, (sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/4 - (cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/4 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/4 - (cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/4, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                  0, (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (11*cos(q2 + q3)*cos(q1))/100 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                       (11*sin(q2 + q3)*sin(q1))/100 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                   (11*sin(q2 + q3)*sin(q1))/100 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 12:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (53*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 + (53*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (53*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (53*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200, (299*cos(q2)*sin(qb))/625 + (53*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (53*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (299*cos(q1)*cos(qb)*sin(q2))/625, (53*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (53*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (53*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (53*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (53*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (53*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200, (53*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (53*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (53*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (53*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                            0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (19*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (19*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (19*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 13:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (7*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (7*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (7*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (7*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25, (299*cos(q2)*sin(qb))/625 + (7*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (7*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (299*cos(q1)*cos(qb)*sin(q2))/625, (7*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (7*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (7*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (7*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (7*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (7*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25, (7*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (7*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (7*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (7*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                        0,     (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (2*cos(q2 + q3)*cos(q1))/25 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                               (2*sin(q2 + q3)*sin(q1))/25 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                           (2*sin(q2 + q3)*sin(q1))/25 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 14:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (59*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 + (59*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (59*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (59*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200, (299*cos(q2)*sin(qb))/625 + (59*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (59*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (299*cos(q1)*cos(qb)*sin(q2))/625, (59*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (59*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (59*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 + (59*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (59*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (59*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200, (59*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (59*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (59*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (59*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                            0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (13*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (13*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (13*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 15:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (31*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 + (31*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (31*cos(q2)*cos(q3)*cos(qb)*sin(q1))/100 - (31*cos(qb)*sin(q1)*sin(q2)*sin(q3))/100, (299*cos(q2)*sin(qb))/625 + (31*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (31*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 + (299*cos(q1)*cos(qb)*sin(q2))/625, (31*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (31*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (31*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 + (31*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (31*cos(q2)*cos(q3)*sin(q1)*sin(qb))/100 - (31*sin(q1)*sin(q2)*sin(q3)*sin(qb))/100, (31*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (31*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (31*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (31*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                            0,           (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (cos(q2 + q3)*cos(q1))/20 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                     (sin(q2 + q3)*sin(q1))/20 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                 (sin(q2 + q3)*sin(q1))/20 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 16:
            jacobi_3_15 << 1, 0, (299*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (sin(q1)*sin(qb))/25 + (13*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40 + (13*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40 + (299*cos(q1)*cos(q2)*sin(qb))/625, (cos(q1)*cos(qb))/25 + (299*cos(q2)*cos(qb)*sin(q1))/625 + (13*cos(q2)*cos(q3)*cos(qb)*sin(q1))/40 - (13*cos(qb)*sin(q1)*sin(q2)*sin(q3))/40, (299*cos(q2)*sin(qb))/625 + (13*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40 - (13*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40 + (299*cos(q1)*cos(qb)*sin(q2))/625, (13*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40 - (13*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (cos(qb)*sin(q1))/25 + (299*sin(q2)*sin(qb))/625 + (13*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40 + (13*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40 - (299*cos(q1)*cos(q2)*cos(qb))/625, (cos(q1)*sin(qb))/25 + (299*cos(q2)*sin(q1)*sin(qb))/625 + (13*cos(q2)*cos(q3)*sin(q1)*sin(qb))/40 - (13*sin(q1)*sin(q2)*sin(q3)*sin(qb))/40, (13*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40 - (13*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40 - (299*cos(q2)*cos(qb))/625 + (299*cos(q1)*sin(q2)*sin(qb))/625, (13*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40 - (13*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                          0,      (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (7*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                (7*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                            (7*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        default :
            jacobi_3_15.setZero();
            ROS_ERROR("LS Wrong cell id!");
            std::cout << i << std::endl;
            break;
    }
    return jacobi_3_15;
}


inline Matrix<double, 3, 15> getJacobiantouch_rs(const int i,const double qb, const double q1, const double q2, const double q3, const double q4, const double q5, const double q6)
{
    Matrix<double, 3, 15> jacobi_3_15;
    switch(i){
        case 1: 
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (13*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40 - (13*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (13*cos(qb)*sin(q1)*sin(q2)*sin(q3))/40 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (13*cos(q2)*cos(q3)*cos(qb)*sin(q1))/40 - (cos(q1)*cos(qb))/25, (13*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40 - (13*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (13*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40 - (13*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (13*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40 - (13*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (13*sin(q1)*sin(q2)*sin(q3)*sin(qb))/40 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (13*cos(q2)*cos(q3)*sin(q1)*sin(qb))/40 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (13*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40 - (13*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40 - (299*cos(q1)*sin(q2)*sin(qb))/625, (13*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40 - (13*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                         0, 0, 0, 0, 0, 0, 0,      (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (7*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                (7*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                            (7*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 2:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (31*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (31*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (31*cos(qb)*sin(q1)*sin(q2)*sin(q3))/100 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (31*cos(q2)*cos(q3)*cos(qb)*sin(q1))/100 - (cos(q1)*cos(qb))/25, (31*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 - (31*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (31*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 - (31*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (31*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 - (31*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (31*sin(q1)*sin(q2)*sin(q3)*sin(qb))/100 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (31*cos(q2)*cos(q3)*sin(q1)*sin(qb))/100 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (31*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (31*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (299*cos(q1)*sin(q2)*sin(qb))/625, (31*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (31*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                           0, 0, 0, 0, 0, 0, 0,           (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (cos(q2 + q3)*cos(q1))/20 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                     (sin(q2 + q3)*sin(q1))/20 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                 (sin(q2 + q3)*sin(q1))/20 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 3:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (59*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (59*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (59*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (59*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (cos(q1)*cos(qb))/25, (59*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (59*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (59*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (59*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (59*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (59*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (59*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (59*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (59*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (59*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (299*cos(q1)*sin(q2)*sin(qb))/625, (59*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (59*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                           0, 0, 0, 0, 0, 0, 0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (13*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (13*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (13*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;        
        case 4:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (7*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (7*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (7*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (7*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (cos(q1)*cos(qb))/25, (7*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (7*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (7*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (7*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (7*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (7*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (7*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (7*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (7*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (7*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (299*cos(q1)*sin(q2)*sin(qb))/625, (7*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (7*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                       0, 0, 0, 0, 0, 0, 0,     (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (2*cos(q2 + q3)*cos(q1))/25 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                               (2*sin(q2 + q3)*sin(q1))/25 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                           (2*sin(q2 + q3)*sin(q1))/25 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 5:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (53*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (53*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (53*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (53*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (cos(q1)*cos(qb))/25, (53*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (53*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (53*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (53*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (53*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (53*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (53*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (53*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (53*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (53*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (299*cos(q1)*sin(q2)*sin(qb))/625, (53*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (53*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                           0, 0, 0, 0, 0, 0, 0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (19*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (19*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (19*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 6:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/4 - (sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/4 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0,     (cos(qb)*sin(q1)*sin(q2)*sin(q3))/4 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (cos(q2)*cos(q3)*cos(qb)*sin(q1))/4 - (cos(q1)*cos(qb))/25, (sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/4 - (cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/4 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/4 - (cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/4, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/4 - (sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/4 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0,     (sin(q1)*sin(q2)*sin(q3)*sin(qb))/4 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (cos(q2)*cos(q3)*sin(q1)*sin(qb))/4 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/4 - (sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/4 - (299*cos(q1)*sin(q2)*sin(qb))/625, (cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/4 - (sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/4, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                 0, 0, 0, 0, 0, 0, 0, (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (11*cos(q2 + q3)*cos(q1))/100 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                       (11*sin(q2 + q3)*sin(q1))/100 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                   (11*sin(q2 + q3)*sin(q1))/100 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 7:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (47*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (47*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (47*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (47*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (cos(q1)*cos(qb))/25, (47*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (47*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (47*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (47*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (47*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (47*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (47*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (47*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (47*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (47*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (299*cos(q1)*sin(q2)*sin(qb))/625, (47*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (47*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                           0, 0, 0, 0, 0, 0, 0,            (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (cos(q2 + q3)*cos(q1))/8 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                      (sin(q2 + q3)*sin(q1))/8 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                                  (sin(q2 + q3)*sin(q1))/8 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 8:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (11*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/50 - (11*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/50 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (11*cos(qb)*sin(q1)*sin(q2)*sin(q3))/50 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (11*cos(q2)*cos(q3)*cos(qb)*sin(q1))/50 - (cos(q1)*cos(qb))/25, (11*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/50 - (11*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/50 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (11*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/50 - (11*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/50, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (11*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/50 - (11*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/50 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (11*sin(q1)*sin(q2)*sin(q3)*sin(qb))/50 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (11*cos(q2)*cos(q3)*sin(q1)*sin(qb))/50 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (11*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/50 - (11*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/50 - (299*cos(q1)*sin(q2)*sin(qb))/625, (11*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/50 - (11*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/50, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                         0, 0, 0, 0, 0, 0, 0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (7*cos(q2 + q3)*cos(q1))/50 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (7*sin(q2 + q3)*sin(q1))/50 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (7*sin(q2 + q3)*sin(q1))/50 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 9:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (41*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (41*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (41*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (41*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (cos(q1)*cos(qb))/25, (41*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (41*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (41*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (41*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (41*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (41*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (41*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (41*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (41*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (41*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (299*cos(q1)*sin(q2)*sin(qb))/625, (41*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (41*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                           0, 0, 0, 0, 0, 0, 0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (31*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (31*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (31*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 10:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (19*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (19*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (19*cos(qb)*sin(q1)*sin(q2)*sin(q3))/100 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (19*cos(q2)*cos(q3)*cos(qb)*sin(q1))/100 - (cos(q1)*cos(qb))/25, (19*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 - (19*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (19*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 - (19*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (19*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 - (19*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (19*sin(q1)*sin(q2)*sin(q3)*sin(qb))/100 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (19*cos(q2)*cos(q3)*sin(q1)*sin(qb))/100 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (19*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (19*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (299*cos(q1)*sin(q2)*sin(qb))/625, (19*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (19*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                           0, 0, 0, 0, 0, 0, 0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (17*cos(q2 + q3)*cos(q1))/100 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (17*sin(q2 + q3)*sin(q1))/100 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (17*sin(q2 + q3)*sin(q1))/100 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 11:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (7*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40 - (7*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (7*cos(qb)*sin(q1)*sin(q2)*sin(q3))/40 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (7*cos(q2)*cos(q3)*cos(qb)*sin(q1))/40 - (cos(q1)*cos(qb))/25, (7*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40 - (7*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (7*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40 - (7*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (7*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/40 - (7*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/40 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (7*sin(q1)*sin(q2)*sin(q3)*sin(qb))/40 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (7*cos(q2)*cos(q3)*sin(q1)*sin(qb))/40 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (7*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40 - (7*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40 - (299*cos(q1)*sin(q2)*sin(qb))/625, (7*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/40 - (7*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/40, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                       0, 0, 0, 0, 0, 0, 0,   (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (37*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                             (37*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                         (37*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 12:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (4*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (4*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (4*cos(qb)*sin(q1)*sin(q2)*sin(q3))/25 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (4*cos(q2)*cos(q3)*cos(qb)*sin(q1))/25 - (cos(q1)*cos(qb))/25, (4*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (4*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (4*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (4*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (4*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (4*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (4*sin(q1)*sin(q2)*sin(q3)*sin(qb))/25 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (4*cos(q2)*cos(q3)*sin(q1)*sin(qb))/25 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (4*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (4*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (299*cos(q1)*sin(q2)*sin(qb))/625, (4*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (4*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                       0, 0, 0, 0, 0, 0, 0,        (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (cos(q2 + q3)*cos(q1))/5 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                  (sin(q2 + q3)*sin(q1))/5 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                              (sin(q2 + q3)*sin(q1))/5 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 13:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (29*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (29*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (29*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (29*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (cos(q1)*cos(qb))/25, (29*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (29*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (29*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (29*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (29*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (29*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (29*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (29*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (29*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (29*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (299*cos(q1)*sin(q2)*sin(qb))/625, (29*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (29*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                           0, 0, 0, 0, 0, 0, 0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (43*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (43*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (43*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 14:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (13*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (13*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (13*cos(qb)*sin(q1)*sin(q2)*sin(q3))/100 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (13*cos(q2)*cos(q3)*cos(qb)*sin(q1))/100 - (cos(q1)*cos(qb))/25, (13*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 - (13*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (13*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 - (13*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (13*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/100 - (13*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/100 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (13*sin(q1)*sin(q2)*sin(q3)*sin(qb))/100 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (13*cos(q2)*cos(q3)*sin(q1)*sin(qb))/100 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (13*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (13*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100 - (299*cos(q1)*sin(q2)*sin(qb))/625, (13*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/100 - (13*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/100, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                           0, 0, 0, 0, 0, 0, 0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (23*cos(q2 + q3)*cos(q1))/100 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (23*sin(q2 + q3)*sin(q1))/100 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (23*sin(q2 + q3)*sin(q1))/100 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 15:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (23*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (23*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, (23*cos(qb)*sin(q1)*sin(q2)*sin(q3))/200 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (23*cos(q2)*cos(q3)*cos(qb)*sin(q1))/200 - (cos(q1)*cos(qb))/25, (23*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (23*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (23*sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (23*cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (23*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/200 - (23*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/200 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, (23*sin(q1)*sin(q2)*sin(q3)*sin(qb))/200 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (23*cos(q2)*cos(q3)*sin(q1)*sin(qb))/200 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (23*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (23*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200 - (299*cos(q1)*sin(q2)*sin(qb))/625, (23*cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/200 - (23*sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/200, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                           0, 0, 0, 0, 0, 0, 0,       (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (49*cos(q2 + q3)*cos(q1))/200 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                                 (49*sin(q2 + q3)*sin(q1))/200 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                             (49*sin(q2 + q3)*sin(q1))/200 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        case 16:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 + (sin(q1)*sin(qb))/25 - (cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/10 - (sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/10 - (299*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0,  (cos(qb)*sin(q1)*sin(q2)*sin(q3))/10 - (299*cos(q2)*cos(qb)*sin(q1))/625 - (cos(q2)*cos(q3)*cos(qb)*sin(q1))/10 - (cos(q1)*cos(qb))/25, (sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/10 - (cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/10 - (299*cos(q2)*sin(qb))/625 - (299*cos(q1)*cos(qb)*sin(q2))/625, (sin(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/10 - (cos(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/10, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (cos(qb)*sin(q1))/25 - (299*sin(q2)*sin(qb))/625 - (cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/10 - (sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/10 + (299*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0,  (sin(q1)*sin(q2)*sin(q3)*sin(qb))/10 - (299*cos(q2)*sin(q1)*sin(qb))/625 - (cos(q2)*cos(q3)*sin(q1)*sin(qb))/10 - (cos(q1)*sin(qb))/25, (299*cos(q2)*cos(qb))/625 + (cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/10 - (sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/10 - (299*cos(q1)*sin(q2)*sin(qb))/625, (cos(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/10 - (sin(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/10, 0, 0, 0,
0, 0,                                                                                                                                                                                                                                                   0, 0, 0, 0, 0, 0, 0, (299*cos(q1)*cos(q2))/625 - sin(q1)/25 - (13*cos(q2 + q3)*cos(q1))/50 + (9*cos(q1)*cos(q2)*cos(q3))/25 - (9*cos(q1)*sin(q2)*sin(q3))/25,                                                          (13*sin(q2 + q3)*sin(q1))/50 - (299*sin(q1)*sin(q2))/625 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25,                      (13*sin(q2 + q3)*sin(q1))/50 - (9*cos(q2)*sin(q1)*sin(q3))/25 - (9*cos(q3)*sin(q1)*sin(q2))/25, 0, 0, 0;
            break;
        default :
            jacobi_3_15.setZero();
            ROS_ERROR("RS Wrong cell id!");
            std::cout << i << std::endl;
            break;
    }
    return jacobi_3_15;
}

/**
    * @brief Get jacobian matrix (linear) for the touch point
    * @detail
    *  Get jacobian matrix for the touch point by the tactile index
    * @param[in] i        tactile index
    * @param[in] q        realtime joint position
    * @param[out] jacobi_3_15        jacobian matrix (linear)
    */
inline Matrix<double, 3, 15> getJacobiantouch_lb(const int i,const double qb, const double q1, const double q2, const double q3, const double q4, const double q5, const double q6)
{
    Matrix<double, 3, 15> jacobi_3_15;
    switch(i){
        case 1: 
            jacobi_3_15 << 1, 0, (273*cos(qb)*sin(q2))/1250 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (273*cos(q1)*cos(q2)*sin(qb))/1250, (1807*cos(q1)*cos(qb))/10000 + (273*cos(q2)*cos(qb)*sin(q1))/1250, (273*cos(q2)*sin(qb))/1250 + (273*cos(q1)*cos(qb)*sin(q2))/1250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (273*sin(q2)*sin(qb))/1250 - (273*cos(q1)*cos(q2)*cos(qb))/1250, (1807*cos(q1)*sin(qb))/10000 + (273*cos(q2)*sin(q1)*sin(qb))/1250, (273*cos(q1)*sin(q2)*sin(qb))/1250 - (273*cos(q2)*cos(qb))/1250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                        0,                 (273*cos(q1)*cos(q2))/1250 - (1807*sin(q1))/10000,                                     -(273*sin(q1)*sin(q2))/1250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 2:
            jacobi_3_15 << 1, 0, (1167*cos(qb)*sin(q2))/5000 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (1167*cos(q1)*cos(q2)*sin(qb))/5000, (1807*cos(q1)*cos(qb))/10000 + (1167*cos(q2)*cos(qb)*sin(q1))/5000, (1167*cos(q2)*sin(qb))/5000 + (1167*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (1167*sin(q2)*sin(qb))/5000 - (1167*cos(q1)*cos(q2)*cos(qb))/5000, (1807*cos(q1)*sin(qb))/10000 + (1167*cos(q2)*sin(q1)*sin(qb))/5000, (1167*cos(q1)*sin(q2)*sin(qb))/5000 - (1167*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                          0,                 (1167*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                      -(1167*sin(q1)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 3:
            jacobi_3_15 << 1, 0, (621*cos(qb)*sin(q2))/2500 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (621*cos(q1)*cos(q2)*sin(qb))/2500, (1807*cos(q1)*cos(qb))/10000 + (621*cos(q2)*cos(qb)*sin(q1))/2500, (621*cos(q2)*sin(qb))/2500 + (621*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (621*sin(q2)*sin(qb))/2500 - (621*cos(q1)*cos(q2)*cos(qb))/2500, (1807*cos(q1)*sin(qb))/10000 + (621*cos(q2)*sin(q1)*sin(qb))/2500, (621*cos(q1)*sin(q2)*sin(qb))/2500 - (621*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                        0,                 (621*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                     -(621*sin(q1)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;        
        case 4:
            jacobi_3_15 << 1, 0, (1317*cos(qb)*sin(q2))/5000 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (1317*cos(q1)*cos(q2)*sin(qb))/5000, (1807*cos(q1)*cos(qb))/10000 + (1317*cos(q2)*cos(qb)*sin(q1))/5000, (1317*cos(q2)*sin(qb))/5000 + (1317*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (1317*sin(q2)*sin(qb))/5000 - (1317*cos(q1)*cos(q2)*cos(qb))/5000, (1807*cos(q1)*sin(qb))/10000 + (1317*cos(q2)*sin(q1)*sin(qb))/5000, (1317*cos(q1)*sin(q2)*sin(qb))/5000 - (1317*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                          0,                 (1317*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                      -(1317*sin(q1)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 5:
            jacobi_3_15 << 1, 0, (174*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (174*cos(q1)*cos(q2)*sin(qb))/625, (1807*cos(q1)*cos(qb))/10000 + (174*cos(q2)*cos(qb)*sin(q1))/625, (174*cos(q2)*sin(qb))/625 + (174*cos(q1)*cos(qb)*sin(q2))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (174*sin(q2)*sin(qb))/625 - (174*cos(q1)*cos(q2)*cos(qb))/625, (1807*cos(q1)*sin(qb))/10000 + (174*cos(q2)*sin(q1)*sin(qb))/625, (174*cos(q1)*sin(q2)*sin(qb))/625 - (174*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                      0,                 (174*cos(q1)*cos(q2))/625 - (1807*sin(q1))/10000,                                    -(174*sin(q1)*sin(q2))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
             break;
        case 6:
            jacobi_3_15 << 1, 0, (1467*cos(qb)*sin(q2))/5000 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (1467*cos(q1)*cos(q2)*sin(qb))/5000, (1807*cos(q1)*cos(qb))/10000 + (1467*cos(q2)*cos(qb)*sin(q1))/5000, (1467*cos(q2)*sin(qb))/5000 + (1467*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (1467*sin(q2)*sin(qb))/5000 - (1467*cos(q1)*cos(q2)*cos(qb))/5000, (1807*cos(q1)*sin(qb))/10000 + (1467*cos(q2)*sin(q1)*sin(qb))/5000, (1467*cos(q1)*sin(q2)*sin(qb))/5000 - (1467*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                          0,                 (1467*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                      -(1467*sin(q1)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 7:
            jacobi_3_15 << 1, 0, (771*cos(qb)*sin(q2))/2500 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (771*cos(q1)*cos(q2)*sin(qb))/2500, (1807*cos(q1)*cos(qb))/10000 + (771*cos(q2)*cos(qb)*sin(q1))/2500, (771*cos(q2)*sin(qb))/2500 + (771*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (771*sin(q2)*sin(qb))/2500 - (771*cos(q1)*cos(q2)*cos(qb))/2500, (1807*cos(q1)*sin(qb))/10000 + (771*cos(q2)*sin(q1)*sin(qb))/2500, (771*cos(q1)*sin(q2)*sin(qb))/2500 - (771*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                        0,                 (771*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                     -(771*sin(q1)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 8:
            jacobi_3_15 << 1, 0, (1617*cos(qb)*sin(q2))/5000 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (1617*cos(q1)*cos(q2)*sin(qb))/5000, (1807*cos(q1)*cos(qb))/10000 + (1617*cos(q2)*cos(qb)*sin(q1))/5000, (1617*cos(q2)*sin(qb))/5000 + (1617*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (1617*sin(q2)*sin(qb))/5000 - (1617*cos(q1)*cos(q2)*cos(qb))/5000, (1807*cos(q1)*sin(qb))/10000 + (1617*cos(q2)*sin(q1)*sin(qb))/5000, (1617*cos(q1)*sin(q2)*sin(qb))/5000 - (1617*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                          0,                 (1617*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                      -(1617*sin(q1)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
           break;
        case 9:
            jacobi_3_15 << 1, 0, (423*cos(qb)*sin(q2))/1250 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (423*cos(q1)*cos(q2)*sin(qb))/1250, (1807*cos(q1)*cos(qb))/10000 + (423*cos(q2)*cos(qb)*sin(q1))/1250, (423*cos(q2)*sin(qb))/1250 + (423*cos(q1)*cos(qb)*sin(q2))/1250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (423*sin(q2)*sin(qb))/1250 - (423*cos(q1)*cos(q2)*cos(qb))/1250, (1807*cos(q1)*sin(qb))/10000 + (423*cos(q2)*sin(q1)*sin(qb))/1250, (423*cos(q1)*sin(q2)*sin(qb))/1250 - (423*cos(q2)*cos(qb))/1250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                        0,                 (423*cos(q1)*cos(q2))/1250 - (1807*sin(q1))/10000,                                     -(423*sin(q1)*sin(q2))/1250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 10:
            jacobi_3_15 << 1, 0, (1767*cos(qb)*sin(q2))/5000 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (1767*cos(q1)*cos(q2)*sin(qb))/5000, (1807*cos(q1)*cos(qb))/10000 + (1767*cos(q2)*cos(qb)*sin(q1))/5000, (1767*cos(q2)*sin(qb))/5000 + (1767*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (1767*sin(q2)*sin(qb))/5000 - (1767*cos(q1)*cos(q2)*cos(qb))/5000, (1807*cos(q1)*sin(qb))/10000 + (1767*cos(q2)*sin(q1)*sin(qb))/5000, (1767*cos(q1)*sin(q2)*sin(qb))/5000 - (1767*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                          0,                 (1767*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                      -(1767*sin(q1)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 11:
            jacobi_3_15 << 1, 0, (921*cos(qb)*sin(q2))/2500 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (921*cos(q1)*cos(q2)*sin(qb))/2500, (1807*cos(q1)*cos(qb))/10000 + (921*cos(q2)*cos(qb)*sin(q1))/2500, (921*cos(q2)*sin(qb))/2500 + (921*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (921*sin(q2)*sin(qb))/2500 - (921*cos(q1)*cos(q2)*cos(qb))/2500, (1807*cos(q1)*sin(qb))/10000 + (921*cos(q2)*sin(q1)*sin(qb))/2500, (921*cos(q1)*sin(q2)*sin(qb))/2500 - (921*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                        0,                 (921*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                     -(921*sin(q1)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 12:
            jacobi_3_15 << 1, 0, (1917*cos(qb)*sin(q2))/5000 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (1917*cos(q1)*cos(q2)*sin(qb))/5000, (1807*cos(q1)*cos(qb))/10000 + (1917*cos(q2)*cos(qb)*sin(q1))/5000, (1917*cos(q2)*sin(qb))/5000 + (1917*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (1917*sin(q2)*sin(qb))/5000 - (1917*cos(q1)*cos(q2)*cos(qb))/5000, (1807*cos(q1)*sin(qb))/10000 + (1917*cos(q2)*sin(q1)*sin(qb))/5000, (1917*cos(q1)*sin(q2)*sin(qb))/5000 - (1917*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                          0,                 (1917*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                      -(1917*sin(q1)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 13:
            jacobi_3_15 << 1, 0, (249*cos(qb)*sin(q2))/625 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (249*cos(q1)*cos(q2)*sin(qb))/625, (1807*cos(q1)*cos(qb))/10000 + (249*cos(q2)*cos(qb)*sin(q1))/625, (249*cos(q2)*sin(qb))/625 + (249*cos(q1)*cos(qb)*sin(q2))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (249*sin(q2)*sin(qb))/625 - (249*cos(q1)*cos(q2)*cos(qb))/625, (1807*cos(q1)*sin(qb))/10000 + (249*cos(q2)*sin(q1)*sin(qb))/625, (249*cos(q1)*sin(q2)*sin(qb))/625 - (249*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                      0,                 (249*cos(q1)*cos(q2))/625 - (1807*sin(q1))/10000,                                    -(249*sin(q1)*sin(q2))/625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 14:
            jacobi_3_15 << 1, 0, (2067*cos(qb)*sin(q2))/5000 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (2067*cos(q1)*cos(q2)*sin(qb))/5000, (1807*cos(q1)*cos(qb))/10000 + (2067*cos(q2)*cos(qb)*sin(q1))/5000, (2067*cos(q2)*sin(qb))/5000 + (2067*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (2067*sin(q2)*sin(qb))/5000 - (2067*cos(q1)*cos(q2)*cos(qb))/5000, (1807*cos(q1)*sin(qb))/10000 + (2067*cos(q2)*sin(q1)*sin(qb))/5000, (2067*cos(q1)*sin(q2)*sin(qb))/5000 - (2067*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                          0,                 (2067*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                      -(2067*sin(q1)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 15:
            jacobi_3_15 << 1, 0, (1071*cos(qb)*sin(q2))/2500 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (1071*cos(q1)*cos(q2)*sin(qb))/2500, (1807*cos(q1)*cos(qb))/10000 + (1071*cos(q2)*cos(qb)*sin(q1))/2500, (1071*cos(q2)*sin(qb))/2500 + (1071*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (1071*sin(q2)*sin(qb))/2500 - (1071*cos(q1)*cos(q2)*cos(qb))/2500, (1807*cos(q1)*sin(qb))/10000 + (1071*cos(q2)*sin(q1)*sin(qb))/2500, (1071*cos(q1)*sin(q2)*sin(qb))/2500 - (1071*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                          0,                 (1071*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                      -(1071*sin(q1)*sin(q2))/2500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 16:
            jacobi_3_15 << 1, 0, (2217*cos(qb)*sin(q2))/5000 - (229*sin(qb))/500 - (1631*cos(qb))/5000 - (1807*sin(q1)*sin(qb))/10000 + (2217*cos(q1)*cos(q2)*sin(qb))/5000, (1807*cos(q1)*cos(qb))/10000 + (2217*cos(q2)*cos(qb)*sin(q1))/5000, (2217*cos(q2)*sin(qb))/5000 + (2217*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 - (1631*sin(qb))/5000 + (1807*cos(qb)*sin(q1))/10000 + (2217*sin(q2)*sin(qb))/5000 - (2217*cos(q1)*cos(q2)*cos(qb))/5000, (1807*cos(q1)*sin(qb))/10000 + (2217*cos(q2)*sin(q1)*sin(qb))/5000, (2217*cos(q1)*sin(q2)*sin(qb))/5000 - (2217*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0,                                                                                                                                          0,                 (2217*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                      -(2217*sin(q1)*sin(q2))/5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
            break;
        case 0:
            jacobi_3_15.setZero();
            break;
        default :
            jacobi_3_15.setZero();
            ROS_ERROR("Lb Wrong cell id!");
            std::cout << i << std::endl;
            break;
    }
    return jacobi_3_15;
}

inline Matrix<double, 3, 15> getJacobiantouch_rb(const int i,const double qb, const double q1, const double q2, const double q3, const double q4, const double q5, const double q6)
{
    Matrix<double, 3, 15> jacobi_3_15;
    switch(i){
        case 1: 
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (2117*cos(qb)*sin(q2))/5000 + (1807*sin(q1)*sin(qb))/10000 - (2117*cos(q1)*cos(q2)*sin(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (2117*cos(q2)*cos(qb)*sin(q1))/5000, - (2117*cos(q2)*sin(qb))/5000 - (2117*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (2117*sin(q2)*sin(qb))/5000 + (2117*cos(q1)*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (2117*cos(q2)*sin(q1)*sin(qb))/5000,   (2117*cos(q2)*cos(qb))/5000 - (2117*cos(q1)*sin(q2)*sin(qb))/5000, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (2117*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                        -(2117*sin(q1)*sin(q2))/5000, 0, 0, 0, 0;
            break;
        case 2:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (1021*cos(qb)*sin(q2))/2500 + (1807*sin(q1)*sin(qb))/10000 - (1021*cos(q1)*cos(q2)*sin(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (1021*cos(q2)*cos(qb)*sin(q1))/2500, - (1021*cos(q2)*sin(qb))/2500 - (1021*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (1021*sin(q2)*sin(qb))/2500 + (1021*cos(q1)*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (1021*cos(q2)*sin(q1)*sin(qb))/2500,   (1021*cos(q2)*cos(qb))/2500 - (1021*cos(q1)*sin(q2)*sin(qb))/2500, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (1021*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                        -(1021*sin(q1)*sin(q2))/2500, 0, 0, 0, 0;
            break;
        case 3:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (1967*cos(qb)*sin(q2))/5000 + (1807*sin(q1)*sin(qb))/10000 - (1967*cos(q1)*cos(q2)*sin(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (1967*cos(q2)*cos(qb)*sin(q1))/5000, - (1967*cos(q2)*sin(qb))/5000 - (1967*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (1967*sin(q2)*sin(qb))/5000 + (1967*cos(q1)*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (1967*cos(q2)*sin(q1)*sin(qb))/5000,   (1967*cos(q2)*cos(qb))/5000 - (1967*cos(q1)*sin(q2)*sin(qb))/5000, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (1967*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                        -(1967*sin(q1)*sin(q2))/5000, 0, 0, 0, 0;
            break;        
        case 4:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (473*cos(qb)*sin(q2))/1250 + (1807*sin(q1)*sin(qb))/10000 - (473*cos(q1)*cos(q2)*sin(qb))/1250, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (473*cos(q2)*cos(qb)*sin(q1))/1250, - (473*cos(q2)*sin(qb))/1250 - (473*cos(q1)*cos(qb)*sin(q2))/1250, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (473*sin(q2)*sin(qb))/1250 + (473*cos(q1)*cos(q2)*cos(qb))/1250, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (473*cos(q2)*sin(q1)*sin(qb))/1250,   (473*cos(q2)*cos(qb))/1250 - (473*cos(q1)*sin(q2)*sin(qb))/1250, 0, 0, 0, 0,
0, 0,                                                                                                                                       0, 0, 0, 0, 0, 0, 0,                   (473*cos(q1)*cos(q2))/1250 - (1807*sin(q1))/10000,                                       -(473*sin(q1)*sin(q2))/1250, 0, 0, 0, 0;
            break;
        case 5:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (1817*cos(qb)*sin(q2))/5000 + (1807*sin(q1)*sin(qb))/10000 - (1817*cos(q1)*cos(q2)*sin(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (1817*cos(q2)*cos(qb)*sin(q1))/5000, - (1817*cos(q2)*sin(qb))/5000 - (1817*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (1817*sin(q2)*sin(qb))/5000 + (1817*cos(q1)*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (1817*cos(q2)*sin(q1)*sin(qb))/5000,   (1817*cos(q2)*cos(qb))/5000 - (1817*cos(q1)*sin(q2)*sin(qb))/5000, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (1817*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                        -(1817*sin(q1)*sin(q2))/5000, 0, 0, 0, 0;
             break;
        case 6:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (871*cos(qb)*sin(q2))/2500 + (1807*sin(q1)*sin(qb))/10000 - (871*cos(q1)*cos(q2)*sin(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (871*cos(q2)*cos(qb)*sin(q1))/2500, - (871*cos(q2)*sin(qb))/2500 - (871*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (871*sin(q2)*sin(qb))/2500 + (871*cos(q1)*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (871*cos(q2)*sin(q1)*sin(qb))/2500,   (871*cos(q2)*cos(qb))/2500 - (871*cos(q1)*sin(q2)*sin(qb))/2500, 0, 0, 0, 0,
0, 0,                                                                                                                                       0, 0, 0, 0, 0, 0, 0,                   (871*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                       -(871*sin(q1)*sin(q2))/2500, 0, 0, 0, 0;
            break;
        case 7:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (1667*cos(qb)*sin(q2))/5000 + (1807*sin(q1)*sin(qb))/10000 - (1667*cos(q1)*cos(q2)*sin(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (1667*cos(q2)*cos(qb)*sin(q1))/5000, - (1667*cos(q2)*sin(qb))/5000 - (1667*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (1667*sin(q2)*sin(qb))/5000 + (1667*cos(q1)*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (1667*cos(q2)*sin(q1)*sin(qb))/5000,   (1667*cos(q2)*cos(qb))/5000 - (1667*cos(q1)*sin(q2)*sin(qb))/5000, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (1667*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                        -(1667*sin(q1)*sin(q2))/5000, 0, 0, 0, 0;
            break;
        case 8:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (199*cos(qb)*sin(q2))/625 + (1807*sin(q1)*sin(qb))/10000 - (199*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (199*cos(q2)*cos(qb)*sin(q1))/625, - (199*cos(q2)*sin(qb))/625 - (199*cos(q1)*cos(qb)*sin(q2))/625, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (199*sin(q2)*sin(qb))/625 + (199*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (199*cos(q2)*sin(q1)*sin(qb))/625,   (199*cos(q2)*cos(qb))/625 - (199*cos(q1)*sin(q2)*sin(qb))/625, 0, 0, 0, 0,
0, 0,                                                                                                                                     0, 0, 0, 0, 0, 0, 0,                   (199*cos(q1)*cos(q2))/625 - (1807*sin(q1))/10000,                                      -(199*sin(q1)*sin(q2))/625, 0, 0, 0, 0;
           break;
        case 9:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (1517*cos(qb)*sin(q2))/5000 + (1807*sin(q1)*sin(qb))/10000 - (1517*cos(q1)*cos(q2)*sin(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (1517*cos(q2)*cos(qb)*sin(q1))/5000, - (1517*cos(q2)*sin(qb))/5000 - (1517*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (1517*sin(q2)*sin(qb))/5000 + (1517*cos(q1)*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (1517*cos(q2)*sin(q1)*sin(qb))/5000,   (1517*cos(q2)*cos(qb))/5000 - (1517*cos(q1)*sin(q2)*sin(qb))/5000, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (1517*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                        -(1517*sin(q1)*sin(q2))/5000, 0, 0, 0, 0;
            break;
        case 10:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (721*cos(qb)*sin(q2))/2500 + (1807*sin(q1)*sin(qb))/10000 - (721*cos(q1)*cos(q2)*sin(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (721*cos(q2)*cos(qb)*sin(q1))/2500, - (721*cos(q2)*sin(qb))/2500 - (721*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (721*sin(q2)*sin(qb))/2500 + (721*cos(q1)*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (721*cos(q2)*sin(q1)*sin(qb))/2500,   (721*cos(q2)*cos(qb))/2500 - (721*cos(q1)*sin(q2)*sin(qb))/2500, 0, 0, 0, 0,
0, 0,                                                                                                                                       0, 0, 0, 0, 0, 0, 0,                   (721*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                       -(721*sin(q1)*sin(q2))/2500, 0, 0, 0, 0;
            break;
        case 11:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (1367*cos(qb)*sin(q2))/5000 + (1807*sin(q1)*sin(qb))/10000 - (1367*cos(q1)*cos(q2)*sin(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (1367*cos(q2)*cos(qb)*sin(q1))/5000, - (1367*cos(q2)*sin(qb))/5000 - (1367*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (1367*sin(q2)*sin(qb))/5000 + (1367*cos(q1)*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (1367*cos(q2)*sin(q1)*sin(qb))/5000,   (1367*cos(q2)*cos(qb))/5000 - (1367*cos(q1)*sin(q2)*sin(qb))/5000, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (1367*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                        -(1367*sin(q1)*sin(q2))/5000, 0, 0, 0, 0;
            break;
        case 12:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (323*cos(qb)*sin(q2))/1250 + (1807*sin(q1)*sin(qb))/10000 - (323*cos(q1)*cos(q2)*sin(qb))/1250, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (323*cos(q2)*cos(qb)*sin(q1))/1250, - (323*cos(q2)*sin(qb))/1250 - (323*cos(q1)*cos(qb)*sin(q2))/1250, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (323*sin(q2)*sin(qb))/1250 + (323*cos(q1)*cos(q2)*cos(qb))/1250, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (323*cos(q2)*sin(q1)*sin(qb))/1250,   (323*cos(q2)*cos(qb))/1250 - (323*cos(q1)*sin(q2)*sin(qb))/1250, 0, 0, 0, 0,
0, 0,                                                                                                                                       0, 0, 0, 0, 0, 0, 0,                   (323*cos(q1)*cos(q2))/1250 - (1807*sin(q1))/10000,                                       -(323*sin(q1)*sin(q2))/1250, 0, 0, 0, 0;
            break;
        case 13:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (1217*cos(qb)*sin(q2))/5000 + (1807*sin(q1)*sin(qb))/10000 - (1217*cos(q1)*cos(q2)*sin(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (1217*cos(q2)*cos(qb)*sin(q1))/5000, - (1217*cos(q2)*sin(qb))/5000 - (1217*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (1217*sin(q2)*sin(qb))/5000 + (1217*cos(q1)*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (1217*cos(q2)*sin(q1)*sin(qb))/5000,   (1217*cos(q2)*cos(qb))/5000 - (1217*cos(q1)*sin(q2)*sin(qb))/5000, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (1217*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                        -(1217*sin(q1)*sin(q2))/5000, 0, 0, 0, 0;
           break;
        case 14:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (571*cos(qb)*sin(q2))/2500 + (1807*sin(q1)*sin(qb))/10000 - (571*cos(q1)*cos(q2)*sin(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (571*cos(q2)*cos(qb)*sin(q1))/2500, - (571*cos(q2)*sin(qb))/2500 - (571*cos(q1)*cos(qb)*sin(q2))/2500, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (571*sin(q2)*sin(qb))/2500 + (571*cos(q1)*cos(q2)*cos(qb))/2500, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (571*cos(q2)*sin(q1)*sin(qb))/2500,   (571*cos(q2)*cos(qb))/2500 - (571*cos(q1)*sin(q2)*sin(qb))/2500, 0, 0, 0, 0,
0, 0,                                                                                                                                       0, 0, 0, 0, 0, 0, 0,                   (571*cos(q1)*cos(q2))/2500 - (1807*sin(q1))/10000,                                       -(571*sin(q1)*sin(q2))/2500, 0, 0, 0, 0;
            break;
        case 15:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (1067*cos(qb)*sin(q2))/5000 + (1807*sin(q1)*sin(qb))/10000 - (1067*cos(q1)*cos(q2)*sin(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (1067*cos(q2)*cos(qb)*sin(q1))/5000, - (1067*cos(q2)*sin(qb))/5000 - (1067*cos(q1)*cos(qb)*sin(q2))/5000, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (1067*sin(q2)*sin(qb))/5000 + (1067*cos(q1)*cos(q2)*cos(qb))/5000, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (1067*cos(q2)*sin(q1)*sin(qb))/5000,   (1067*cos(q2)*cos(qb))/5000 - (1067*cos(q1)*sin(q2)*sin(qb))/5000, 0, 0, 0, 0,
0, 0,                                                                                                                                         0, 0, 0, 0, 0, 0, 0,                   (1067*cos(q1)*cos(q2))/5000 - (1807*sin(q1))/10000,                                        -(1067*sin(q1)*sin(q2))/5000, 0, 0, 0, 0;
            break;
        case 16:
            jacobi_3_15 << 1, 0, (409*cos(qb))/1250 - (229*sin(qb))/500 - (124*cos(qb)*sin(q2))/625 + (1807*sin(q1)*sin(qb))/10000 - (124*cos(q1)*cos(q2)*sin(qb))/625, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*cos(qb))/10000 - (124*cos(q2)*cos(qb)*sin(q1))/625, - (124*cos(q2)*sin(qb))/625 - (124*cos(q1)*cos(qb)*sin(q2))/625, 0, 0, 0, 0,
0, 1, (229*cos(qb))/500 + (409*sin(qb))/1250 - (1807*cos(qb)*sin(q1))/10000 - (124*sin(q2)*sin(qb))/625 + (124*cos(q1)*cos(q2)*cos(qb))/625, 0, 0, 0, 0, 0, 0, - (1807*cos(q1)*sin(qb))/10000 - (124*cos(q2)*sin(q1)*sin(qb))/625,   (124*cos(q2)*cos(qb))/625 - (124*cos(q1)*sin(q2)*sin(qb))/625, 0, 0, 0, 0,
0, 0,                                                                                                                                     0, 0, 0, 0, 0, 0, 0,                   (124*cos(q1)*cos(q2))/625 - (1807*sin(q1))/10000,                                      -(124*sin(q1)*sin(q2))/625, 0, 0, 0, 0;

            break;
        default :
            jacobi_3_15.setZero();
            // ROS_ERROR("RB Wrong cell id!");
            // std::cout << i << std::endl;
            break;
    }
    return jacobi_3_15;
}

/**
    * @brief Get jacobian matrix (rotate) for the touch point
    * @detail
    *  Get jacobian matrix for the touch point by the tactile index
    * @param[in] i        tactile index
    * @param[in] q        realtime joint position
    * @param[out] jacobi_3_15_w        jacobian matrix (rotate)
    */
inline Matrix<double, 3, 15> getJacobianrotate_ls(const double qb, const double q1, const double q2, const double q3, const double q4, const double q5, const double q6)
{
    Matrix<double, 3, 15> jacobi_3_15_w;
    jacobi_3_15_w << 0, 0, 0, -sin(qb), cos(qb)*sin(q1), cos(qb)*sin(q1), 0, 0, 0, 0 , 0,0,0,0,0,
0, 0, 0,  cos(qb), sin(q1)*sin(qb), sin(q1)*sin(qb), 0, 0, 0, 0,0,0,0,0,0,
0, 0, 1,        0,         cos(q1),         cos(q1),         0, 0, 0, 0,0,0,0,0,0;                                                                                                                                                                                                                                      1,                                                                                                                                            0,                                                                                                                                                                                   cos(q1),                                                                                                                   cos(q1),         cos(q1), 0, 0, 0, 0, 0, 0, 0, 0;
    return jacobi_3_15_w;
}

/**
    * @brief Get jacobian matrix (rotate) for the touch point
    * @detail
    *  Get jacobian matrix for the touch point by the tactile index
    * @param[in] i        tactile index
    * @param[in] q        realtime joint position
    * @param[out] jacobi_3_15_w        jacobian matrix (rotate)
    */
inline Matrix<double, 3, 15> getJacobianrotate_rs(const double qb, const double q1, const double q2, const double q3, const double q4, const double q5, const double q6)
{
    Matrix<double, 3, 15> jacobi_3_15_w;
    jacobi_3_15_w << 0, 0, 0, 0, 0, 0, 0, 0, 0,  sin(qb), -cos(qb)*sin(q1), -cos(qb)*sin(q1), 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, -cos(qb), -sin(q1)*sin(qb), -sin(q1)*sin(qb), 0, 0, 0,
0, 0, 1, 0, 0, 0, 0, 0, 0,        0,          cos(q1),          cos(q1),         0, 0, 0;                                                                                                                                                                                                                                      1,                                                                                                                                            0,                                                                                                                                                                                   cos(q1),                                                                                                                   cos(q1),         cos(q1), 0, 0, 0, 0, 0, 0, 0, 0;
    return jacobi_3_15_w;
}

/**
    * @brief Get jacobian matrix (rotate) for the touch point
    * @detail
    *  Get jacobian matrix for the touch point by the tactile index
    * @param[in] i        tactile index
    * @param[in] q        realtime joint position
    * @param[out] jacobi_3_15_w        jacobian matrix (rotate)
    */
inline Matrix<double, 3, 15> getJacobianrotate_lb(const double qb, const double q1, const double q2, const double q3, const double q4, const double q5, const double q6)
{
    Matrix<double, 3, 15> jacobi_3_15_w;
    jacobi_3_15_w << 0, 0, 0, -sin(qb), cos(qb)*sin(q1), 0, 0, 0, 0, 0 , 0,0,0,0,0,
0, 0, 0,  cos(qb), sin(q1)*sin(qb), 0, 0, 0, 0, 0,0,0,0,0,0,
0, 0, 1,        0,         cos(q1),        0,         0, 0, 0, 0,0,0,0,0,0;         
    jacobi_3_15_w.setZero();     return jacobi_3_15_w;
}

/**
    * @brief Get jacobian matrix (rotate) for the touch point
    * @detail
    *  Get jacobian matrix for the touch point by the tactile index
    * @param[in] i        tactile index
    * @param[in] q        realtime joint position
    * @param[out] jacobi_3_15_w        jacobian matrix (rotate)
    */
inline Matrix<double, 3, 15> getJacobianrotate_rb(const double qb, const double q1, const double q2, const double q3, const double q4, const double q5, const double q6)
{
    Matrix<double, 3, 15> jacobi_3_15_w;
    jacobi_3_15_w << 0, 0, 0, 0, 0, 0, 0, 0, 0,  sin(qb), -cos(qb)*sin(q1), 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, -cos(qb), -sin(q1)*sin(qb), 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 1,        0,          cos(q1),          0,  0, 0, 0;
    return jacobi_3_15_w;
}

inline Vector3d getpoint_ls(const double xwb, const double ywb, const double qb, const double q1, const double q2, const double q3, const double q4, const double q5){
    Vector3d point;
    point << xwb + (229*cos(qb))/500 - (409*sin(qb))/1250 + (299*sin(q2)*sin(qb))/625 + (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 + (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 - (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb + (409*cos(qb))/1250 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 - (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 - (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 - (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                                     (299*cos(q2)*sin(q1))/625 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
   return point;
}

inline Vector3d getpoint_rs(const double xwb, const double ywb, const double qb, const double q1, const double q2, const double q3, const double q4, const double q5){
    Vector3d point;
    point << xwb + (229*cos(qb))/500 + (409*sin(qb))/1250 - (299*sin(q2)*sin(qb))/625 - (9*cos(q3)*(sin(q2)*sin(qb) - cos(q1)*cos(q2)*cos(qb)))/25 - (9*sin(q3)*(cos(q2)*sin(qb) + cos(q1)*cos(qb)*sin(q2)))/25 + (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb - (409*cos(qb))/1250 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 + (9*cos(q3)*(cos(qb)*sin(q2) + cos(q1)*cos(q2)*sin(qb)))/25 + (9*sin(q3)*(cos(q2)*cos(qb) - cos(q1)*sin(q2)*sin(qb)))/25 + (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                                                                                     (299*cos(q2)*sin(q1))/625 - (9*sin(q1)*sin(q2)*sin(q3))/25 + (9*cos(q2)*cos(q3)*sin(q1))/25 + 6.0/5;
    return point;
}


inline Vector3d getpoint_lb(const double xwb, const double ywb, const double qb, const double q1, const double q2, const double q3, const double q4, const double q5){
    Vector3d point;
    point << xwb + (229*cos(qb))/500 - (409*sin(qb))/1250 + (299*sin(q2)*sin(qb))/625 - (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb + (409*cos(qb))/1250 + (229*sin(qb))/500 - (299*cos(qb)*sin(q2))/625 - (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                             (299*cos(q2)*sin(q1))/625 + 6.0/5;
    return point;
}

inline Vector3d getpoint_rb(const double xwb, const double ywb, const double qb, const double q1, const double q2, const double q3, const double q4, const double q5){
    Vector3d point;
        point << xwb + (229*cos(qb))/500 + (409*sin(qb))/1250 - (299*sin(q2)*sin(qb))/625 + (299*cos(q1)*cos(q2)*cos(qb))/625,
ywb - (409*cos(qb))/1250 + (229*sin(qb))/500 + (299*cos(qb)*sin(q2))/625 + (299*cos(q1)*cos(q2)*sin(qb))/625,
                                                                             (299*cos(q2)*sin(q1))/625 + 6.0/5;
    return point;
}
}

namespace MathTool
{
    /**
        * @brief Get priority weight alpha
        * @detail
        *  Get priority weight alpha for touch point
        * @param[in] force        Force msg from tactile sensor
        * @param[out] alpha        priority weight for this point
        */
    inline double get_weight(double force,const double b = 5)
    {
        double force_abs = fabs(force);
        double alpha = (1 - exp(-b*force_abs))/(1 + exp(-b*force_abs));
        return alpha;
    }

    /**
    * @brief Get pseudoinverse matrix
    * @detail
    *  Get pseudoinverse matrix of the input matrix
    * @param[in] input_matrix        input matrix
    * @param[out] get_inv(MatrixXd input_matrix)        the pseudoinverse matrix of input matrix
    */
    inline MatrixXd get_inv(const MatrixXd &input_matrix, const double threshold = 0.3)
    {
        // SVD Singular Value Decomposition

        JacobiSVD<Eigen::MatrixXd> svd(input_matrix, ComputeFullU | ComputeFullV);

        MatrixXd U = svd.matrixU();
        MatrixXd V = svd.matrixV();
        MatrixXd S = U.inverse() * input_matrix * V.transpose().inverse();

        // In avoiad of Singurity
        for (int i = 0; i < S.rows(); i++)
        {

            if (S(i, i) < threshold)
            {
                S(i, i) = 1.0 / threshold;
            }
            else
            {
                S(i, i) = 1 / S(i, i);
            }
        }

        // Return a inverse matrix
        MatrixXd inv;
        inv = V * S.transpose() * U.transpose();
        return inv;
    }
}